/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmory imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmory exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		Object.defineProperty(exports, name, {
/******/ 			configurable: false,
/******/ 			enumerable: true,
/******/ 			get: getter
/******/ 		});
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

"use strict";
eval("'use strict'; \r\nvar usrContent = angular.module('usrContent', ['summernote', 'ui.mask', 'AxelSoft']);\r\n\r\nusrContent.controller('ctrlEditProfile',\r\n    ['$scope', '$rootScope', '$filter', '$timeout', '$http', '$q', 'Usr', 'Countries', 'PersnlInfo', 'EducBg', 'EmpHistory', 'ChrRef', 'ProfForms',\r\n    function($scope, $rootScope, $filter, $timeout, $http, $q, Usr, Countries, PersnlInfo, EducBg, EmpHistory, ChrRef, ProfForms) {\r\n\r\n  $scope.proform = ProfForms.query();\r\n  $scope.frm1_loader = false;\r\n  $scope.frm2_loader = false;\r\n  $scope.frm3_loader = false;\r\n  ProfForms.query().$promise.then(function(data) {\r\n      $scope.proform = data;\r\n      var actvfrm = 0,\r\n          actvfrm2 = 0,\r\n          actvfrm3 = 0,\r\n          actvfrm4 = 0;\r\n      switch(data['personalinfo']){\r\n        case 0:\r\n          actvfrm = 1;\r\n          break;\r\n        case 1:\r\n          actvfrm = 0;\r\n          break;\r\n      }\r\n      switch(data['educationalbg']){\r\n          case 0:\r\n              actvfrm2 = 1;\r\n              break;\r\n          case 1:\r\n              actvfrm2 = 0;\r\n              break;\r\n      }\r\n      switch(data['emphistory']){\r\n          case 0:\r\n              actvfrm3 = 1;\r\n              break;\r\n          case 1:\r\n              actvfrm3 = 0;\r\n              break;\r\n      }\r\n      switch(data['charreference']){\r\n          case 0:\r\n              actvfrm4 = 1;\r\n              break;\r\n          case 1:\r\n              actvfrm4 = 0;\r\n              break;\r\n      }\r\n      $timeout(function(){\r\n          if(data['personalinfo'] && !data['educationalbg']){\r\n              $scope.collapseTab(2);\r\n          }\r\n          if(data['personalinfo'] && data['educationalbg'] && !data['emphistory']){\r\n              $scope.collapseTab(3);\r\n          }\r\n          if(data['personalinfo'] && data['educationalbg'] && data['emphistory'] && !data['charreference']){\r\n              $scope.collapseTab(4);\r\n          }\r\n      }, 200);\r\n      $scope.forms = [\r\n          {'form':  'PersonalInfo', 'cardnum': 0, 'actvform': actvfrm},\r\n          {'form':  'EducationalBg', 'cardnum': 1, 'actvform': actvfrm2},\r\n          {'form':  'EmploymentHistory', 'cardnum': 1, 'actvform': actvfrm3},\r\n          {'form':  'CharacterReference', 'cardnum': 1, 'actvform': actvfrm4}\r\n      ];\r\n  });\r\n  \r\n  $scope.openForm = function(cardnum, card){\r\n    switch(card){\r\n      case 0:\r\n        $scope.forms[cardnum]['actvform'] = 0;\r\n        break;\r\n      case 1:\r\n        $scope.forms[cardnum]['actvform'] = 1;\r\n        break;\r\n    }\r\n    // console.log(card);\r\n    if($scope.msg['success']){\r\n        $scope.msg['success'] = '';\r\n    }\r\n    var fadefrm = cardnum+1;\r\n    angular.element('.card:nth-child('+fadefrm+') .crdbdy').hide().delay(200).fadeIn();\r\n  }\r\n  $scope.updateUsr = function(){\r\n    Usr.query().$promise.then(function(data) {\r\n        $rootScope.usr = data;\r\n    });\r\n  }\r\n  $scope.msg = [];\r\n  $scope.countries = Countries.query();\r\n  $scope.frm1 = [];\r\n  $scope.frmx1 = false;\r\n  $scope.frmx2 = false;\r\n  PersnlInfo.query().$promise.then(function(data) {\r\n    $scope.frm1 = data[0];\r\n    $scope.frmx1 = data.length ? true : false;\r\n    if($scope.frm1){\r\n      $scope.cvlstatus = $scope.frm1.cstatus;\r\n      $scope.country = $scope.frm1.country;\r\n      $scope.nationality = $scope.frm1.nationality;\r\n    }\r\n  });\r\n\r\n  $scope.select_status = {\r\n    onSelect: function (item) {\r\n      $scope.frm1.cstatus = item.id;\r\n    }\r\n  };\r\n  $scope.select_country = {\r\n    onSelect: function (item) {\r\n      $scope.frm1.country = item.id;\r\n    }\r\n  };\r\n  $scope.select_nationality = {\r\n    onSelect: function (item) {\r\n      $scope.frm1.nationality = item.id;\r\n    }\r\n  };\r\n  $scope.cstatus = [\r\n      {id: 1, name: 'Single'},\r\n      {id: 2, name: 'Married'},\r\n      {id: 3, name: 'Legally separated'},\r\n      {id: 4, name: 'Annulled'},\r\n      {id: 5, name: 'Widow'},\r\n      {id: 6, name: 'Widower'}\r\n  ];\r\n\r\n  $scope.imgForm = function(imgtarget){\r\n    $timeout(function(){\r\n      $scope.imgtarget = imgtarget;\r\n    }, 10);\r\n  }\r\n\r\n  $scope.img_coordinates = function(coordinates){\r\n    $scope.coordinates = coordinates;\r\n  }\r\n\r\n  $scope.cancelUpload = function(){\r\n    $scope.imgtarget = '';\r\n    angular.element('.upload').val('');\r\n    angular.element('#target').data('Jcrop').destroy();\r\n    angular.element('#target').attr('src', '');\r\n  }\r\n\r\n  $scope.uploadFile = function(files){\r\n    $http({\r\n      method: 'POST',\r\n      url: '/upload_dp',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n\r\n        fd.append('coordinates', angular.toJson(data.coordinates));\r\n        angular.forEach(data.img_files, function(file){\r\n           fd.append('file', file);\r\n        });\r\n        return fd;\r\n      },\r\n      data: {img_files: files, coordinates: $scope.coordinates}\r\n    }).then(function(result){\r\n      console.log(result.data);\r\n      \r\n      var msg = result.data;\r\n\r\n      if(!msg['dp']['success']){\r\n          $scope.msg = '';\r\n      }else{\r\n          $scope.msg = msg;\r\n          $scope.updateUsr();\r\n          $scope.timestamp();\r\n          $scope.cancelUpload();\r\n          angular.element('#cropModal').modal('hide');\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  $scope.deleteRecord = function(num){\r\n    $http({\r\n      method: 'POST',\r\n      url: '/delete_record',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n\r\n        fd.append('num', angular.toJson(data.num));\r\n        return fd;\r\n      },\r\n      data: {num: num}\r\n    }).then(function(result){\r\n      var msg = result.data;\r\n      var msg_dtl = [];\r\n      if(msg['dpimg']){\r\n        msg_dtl = msg['dpimg']['dlt']['success'];\r\n      }\r\n      if(msg['rsm']){\r\n        msg_dtl = msg['rsm']['dlt']['success'];\r\n      }\r\n      if(!msg_dtl){\r\n        $scope.msg = '';\r\n      }else{\r\n        $scope.msg = msg;\r\n        $rootScope.usr = Usr.query();\r\n      }\r\n    });\r\n  }\r\n  $scope.dltemp = [];\r\n  $scope.dltchr = [];\r\n  $scope.clsbbl = function(num, index){\r\n    switch(num){\r\n      case 0:\r\n        $scope.dltdp = false;\r\n        break;\r\n      case 1:\r\n        $scope.dltrsm = false;\r\n        break;\r\n      case 2:\r\n        $scope.frm1cnfrm = false;\r\n        break;\r\n      case 'dltemp':\r\n        $scope.dltemp[index] = false;\r\n        break;\r\n      case 'dltchr':\r\n        $scope.dltchr[index] = false;\r\n        break;\r\n    }\r\n  }\r\n\r\n  angular.element('#edtprof_accrdn .card:nth-child(1) .collapse').collapse('show');\r\n  angular.element('#edtprof_accrdn .card .card-header').addClass('collapsed');\r\n  angular.element('#edtprof_accrdn .card:nth-child(1) .card-header').removeClass('collapsed');\r\n  angular.element('#edtprof_accrdn .card .collapse').collapse('hide');\r\n  var current_num = 1;\r\n\r\n  $scope.collapseTab = function(num){\r\n    if(!angular.element('#edtprof_accrdn .card:nth-child('+num+')').hasClass('disabled')){\r\n      angular.element('#edtprof_accrdn .card .collapse').collapse('hide');\r\n      angular.element('#edtprof_accrdn .card:nth-child('+num+') .collapse').collapse('show');\r\n      \r\n      if(current_num == num){\r\n        angular.element('#edtprof_accrdn .card:nth-child('+num+') .card-header').toggleClass('collapsed');\r\n      }else{\r\n        angular.element('#edtprof_accrdn .card .card-header').addClass('collapsed');\r\n        angular.element('#edtprof_accrdn .card:nth-child('+num+') .card-header').toggleClass('collapsed');\r\n      }\r\n      current_num = num;\r\n    }\r\n  }\r\n\r\n  $scope.summernote_options = {\r\n    toolbar: [\r\n      ['edit',['undo','redo']],\r\n      ['style', ['bold', 'italic', 'underline']],\r\n      ['alignment', ['ul', 'ol', 'paragraph', 'lineheight']]\r\n            \r\n    ]\r\n  };\r\n  $scope.makeSameAddress = function(check, frm1){\r\n    if(check == true){\r\n      $scope.frm1 = frm1;\r\n      $scope.frm1.permanent_address = angular.copy($scope.frm1.present_address);\r\n    }\r\n  }\r\n  $scope.success_prsnl = false;\r\n  $scope.success_educ = false;\r\n  $scope.success_emp = false;\r\n  $scope.success_chr = false;\r\n  $scope.savePersonalInfo = function(frmusr){\r\n    $scope.frm1_loader = true;\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/save_personal_info',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('frmusr', angular.toJson(data.frmusr));\r\n        return fd;\r\n      },\r\n      data: {frmusr: frmusr}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n      if(!$scope.msg['error']){\r\n        $scope.forms[0]['actvform'] = 0;\r\n      }\r\n      angular.element('.card:nth-child(1) .crdbdy').hide().delay(200).fadeIn();\r\n      $timeout(function(){\r\n        $scope.frm1_loader = false;\r\n        if($scope.msg['success']){\r\n          if($scope.msg['success']['prsnl']['added']){\r\n            $scope.frmx1 = true;\r\n            $scope.collapseTab(2);\r\n            $scope.proform['personalinfo'] = 1;\r\n            // updating resume\r\n            $scope.updateUsr();\r\n          }\r\n          $scope.success_prsnl = true;\r\n          $timeout(function(){\r\n            $scope.success_prsnl = false;\r\n          }, 3500);\r\n        }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['prsnl']){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n        }\r\n      }\r\n      console.log($scope.msg);\r\n    });\r\n  }\r\n  $scope.jpemps = [];\r\n  $scope.empbtndisable = false;\r\n  $scope.check_emps = function(){\r\n    if($scope.emps && $scope.jpemps){\r\n      if($scope.emps.length > 3 - $scope.jpemps.length){\r\n        $scope.empbtndisable = true;\r\n      }\r\n    }\r\n  }\r\n  EmpHistory.query().$promise.then(function(data) {\r\n    $scope.jpemps = data;\r\n    $scope.empchckbx = $filter('filter')($scope.jpemps, {ispresent: true}).length ? true : false;\r\n    var noworkexprnce = $scope.jpemps.length ? true : false;\r\n    $scope.check_emps();\r\n    $timeout(function(){\r\n      if($scope.frm1){\r\n        $scope.wrkexperience = $scope.frm1.wrkexperience;\r\n        if(!$scope.jpemps.length && $scope.frm1.wrkexperience > 1){\r\n          $scope.emps = [{\r\n            'empid'          : $scope.genid(),\r\n            'company'        : \"\",\r\n            'position'       : \"\",\r\n            'salary'         : \"\",\r\n            'sdate'          : \"\",\r\n            'edate'          : \"\",\r\n            'ispresent'      : \"\",\r\n            'jbdescription'  : \"<ul><li></li><li></li><li></li><li></li></ul>\",\r\n            'reasonforleaving' : \"<ul><li></li><li></li><li></li><li></li></ul>\"\r\n          }];\r\n        }\r\n      }\r\n    }, 100);\r\n    $scope.yrsxprncs = [\r\n        {id: 1, name: 'No Work Experience', disabled: noworkexprnce},\r\n        {id: 2, name: '1-3 Yrs. of Experience', disabled: false},\r\n        {id: 3, name: '4-6 Yrs. of Experience', disabled: false},\r\n        {id: 4, name: '7 yrs. and Above', disabled: false}\r\n    ];\r\n  });\r\n  // $scope.jpemps = [];\r\n  $scope.msg['error'] = [];\r\n  $scope.schl = {\r\n      'name'        : \"\",\r\n      'course'      : \"\",\r\n      'sdate'       : \"\",\r\n      'edate'       : \"\",\r\n      'awardsrecognition'  : \"<ul><li></li><li></li><li></li><li></li></ul>\"\r\n    };\r\n  EducBg.query().$promise.then(function(data) {\r\n    $scope.schl = data.length ? data[0] : $scope.schl;\r\n    $scope.frmx2 = data.length ? true : false;\r\n  });\r\n  $scope.saveEducBg = function(schl){\r\n    $scope.frm2_loader = true;\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/save_educational_bg',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('schl', angular.toJson(data.schl));\r\n        return fd;\r\n      },\r\n      data: {schl: schl}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n      if(!$scope.msg['error']){\r\n        $scope.forms[1]['actvform'] = 0;\r\n      }\r\n      angular.element('.card:nth-child(2) .crdbdy').hide().delay(200).fadeIn();\r\n      $timeout(function(){\r\n          $scope.frm2_loader = false;\r\n          if($scope.msg['success']){\r\n            if($scope.msg['success']['educbg']['added']){\r\n              $scope.collapseTab(3);\r\n              $scope.proform['educationalbg'] = 1;\r\n              $scope.frmx2 = true;\r\n            }\r\n            $scope.success_educ = true;\r\n              \r\n            $timeout(function(){\r\n              $scope.success_educ = false;\r\n            }, 3500);\r\n          }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['educbg']){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n        }\r\n      }\r\n      console.log($scope.msg);\r\n    });\r\n  }\r\n\r\n  $scope.currencies = [\r\n      { id: 1, name: 'USD $' },\r\n      { id: 2, name: 'Php ₱' }\r\n  ];\r\n  \r\n  $scope.getAge = function(bday){\r\n    var current_date    = new Date();\r\n    var current_yr      = current_date.getFullYear();\r\n    var current_mo      = current_date.getMonth();\r\n\r\n    var bdate           = new Date(bday);\r\n    if ( Object.prototype.toString.call(bdate) === \"[object Date]\" ) {\r\n      if (!isNaN(bdate.getTime())){\r\n        var bdate_yr        = bdate.getFullYear();\r\n        var bdate_mo        = bdate.getMonth();\r\n        var your_yr         = current_yr - bdate_yr;\r\n        var your_mo         = current_mo - bdate_mo;\r\n        if(your_mo < 0 || (your_mo === 0 && current_date.getDate() < bdate.getDate())){\r\n            your_yr--;\r\n        }\r\n\r\n        $scope.frm1.age = your_yr;\r\n        // console.log($scope.frm1.age);\r\n      }\r\n    }\r\n  }\r\n\r\n  $scope.gender = [\r\n    {id: 1, name: 'Female'},\r\n    {id: 2, name: 'Male'}\r\n  ];\r\n\r\n  var fltr = '';\r\n  $scope.getfltrvalue = function(arr, arr_id, idntfr){\r\n    if($filter('filter')(arr, {id: arr_id})[0]){\r\n      switch(idntfr){\r\n        case 0:\r\n          fltr = $filter('filter')(arr, {id: arr_id})[0].name;\r\n          break;\r\n        case 1:\r\n          fltr = $filter('filter')(arr, {id: arr_id})[0].country;\r\n          break;\r\n        case 2:\r\n          fltr = $filter('filter')(arr, {id: arr_id})[0].nationality;\r\n          break;\r\n      }\r\n      return fltr;\r\n    }\r\n  }\r\n\r\n  $scope.emps = [];\r\n  \r\n  $scope.saveEmploymentHistory = function(emp){\r\n    $scope.frm3_loader = true;\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/save_employment_history',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('emp', angular.toJson(data.emp));\r\n        return fd;\r\n      },\r\n      data: {emp: emp}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n      $timeout(function(){\r\n        $scope.frm3_loader = false;\r\n        if($scope.msg['success']){\r\n          if($scope.msg['success']['emphistory']){\r\n            $scope.emps = [];\r\n            angular.forEach(emp, function(val, key){\r\n              $scope.jpemps.push({\r\n                'empid'          : val.empid,\r\n                'company'        : val.company,\r\n                'position'       : val.position,\r\n                'currency'       : val.currency,\r\n                'salary'         : val.salary,\r\n                'sdate'          : val.sdate,\r\n                'edate'          : val.edate,\r\n                'ispresent'      : val.ispresent,\r\n                'jbdescription'  : val.jbdescription,\r\n                'reasonforleaving' : val.reasonforleaving\r\n              });\r\n              if($scope.msg['to_char_ref'] == true){\r\n                $scope.collapseTab(4);\r\n                $scope.proform['emphistory'] = 1;\r\n                $scope.success_emp = true;\r\n              }\r\n\r\n              // updating resume\r\n              $scope.updateUsr();\r\n            });\r\n            $timeout(function(){\r\n              $scope.success_emp = false;\r\n            }, 3500); \r\n          }\r\n        }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['emphistory']){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n        }\r\n      }\r\n      console.log($scope.msg);\r\n    });\r\n  }\r\n  $scope.updateEmpHistory = function(idx, emp){\r\n    $scope.frm3_loader = true;\r\n    $http({\r\n        method: 'POST',\r\n        url: '/user/update_employment_history',\r\n        headers: { 'Content-Type': undefined },\r\n        transformRequest: function (data) {\r\n            var fd = new FormData();\r\n            fd.append('emp', angular.toJson(data.emp));\r\n            fd.append('idx', angular.toJson('indx'+data.idx));\r\n            return fd;\r\n        },\r\n        data: {emp: emp, idx: idx}\r\n    }).then(function(result){\r\n        $scope.msg = result.data;\r\n        $timeout(function(){\r\n          $scope.frm3_loader = false;\r\n        }, 200);\r\n        if($scope.msg['success_emp']){\r\n          window.scrollTo('', angular.element(\".empko\"+idx).offset().top - 80);\r\n          $scope.jphide[idx] = false;\r\n          $scope.frmempupdt = false;\r\n\r\n          // updating resume\r\n          $scope.updateUsr();\r\n          $timeout(function(){\r\n            $scope.msg['success_emp'] = null;\r\n          }, 3500);\r\n        }\r\n        $scope.empchckbx = $filter('filter')($scope.jpemps, {ispresent: true}).length ? true : false;\r\n        console.log($scope.msg);\r\n    });\r\n  }\r\n\r\n  $scope.addEmp = function(emp){\r\n    // $scope.wrkexperience = $scope.frm1['wrkexperience'];\r\n    $scope.emps.unshift({\r\n      'empid'          : $scope.genid(),\r\n      'company'        : \"\",\r\n      'position'       : \"\",\r\n      'salary'         : \"\",\r\n      'sdate'          : \"\",\r\n      'edate'          : \"\",\r\n      'ispresent'      : \"\",\r\n      'jbdescription'  : \"<ul><li></li><li></li><li></li><li></li></ul>\",\r\n      'reasonforleaving' : \"<ul><li></li><li></li><li></li><li></li></ul>\"\r\n    });\r\n    if($scope.msg['error']){\r\n      if(typeof $scope.msg['error']['emp'] != \"undefined\"){\r\n        $scope.msg['error']['emp'].splice(0, 0, {});\r\n      }\r\n    }\r\n    $scope.check_emps();\r\n  }\r\n\r\n  $scope.updateEmpForm = function(emp){\r\n    $scope.frm3_loader = true;\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/work_experience',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('wrkexperience', angular.toJson(data.emp));\r\n        return fd;\r\n      },\r\n      data: {emp: emp}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n\r\n      if(!$scope.jpemps.length){\r\n        if(emp >= 1 && $scope.emps.length < 1){\r\n          $scope.emps.unshift({\r\n            'empid'          : $scope.genid(),\r\n            'company'        : \"\",\r\n            'position'       : \"\",\r\n            'salary'         : \"\",\r\n            'sdate'          : \"\",\r\n            'edate'          : \"\",\r\n            'ispresent'      : \"\",\r\n            'jbdescription'  : \"<ul><li></li><li></li><li></li><li></li></ul>\",\r\n            'reasonforleaving' : \"<ul><li></li><li></li><li></li><li></li></ul>\"\r\n          });\r\n        }\r\n      }\r\n      if(emp == 1){\r\n        $scope.emps = [];\r\n      }\r\n\r\n      $timeout(function(){\r\n        $scope.frm3_loader = false;\r\n        // updating resume\r\n        $scope.updateUsr();\r\n        if($scope.msg['success']){\r\n          if($scope.msg['success']['emphistory'] && emp == 1){\r\n            $scope.collapseTab(4);\r\n            $scope.proform['emphistory'] = 1;\r\n            $scope.success_emp = true;\r\n          }\r\n          $timeout(function(){\r\n            $scope.success_emp = false;\r\n          }, 3500); \r\n        }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['emphistory'] && emp == 1){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n        }\r\n      }\r\n      console.log($scope.msg);\r\n    });\r\n      \r\n      // if(typeof emp == 'undefined' || emp == 1){\r\n      //    $scope.emps.push({\r\n      //         'company'        : \"\",\r\n      //         'position'       : \"\",\r\n      //         'salary'         : \"\",\r\n      //         'sdate'          : \"\",\r\n      //         'edate'          : \"\",\r\n      //         'ispresent'      : \"\",\r\n      //         'jbdescription'  : \"<ul><li></li><li></li><li></li><li></li></ul>\",\r\n      //         'reasonforleaving' : \"<ul><li></li><li></li><li></li><li></li></ul>\"\r\n      //     });\r\n      // }\r\n  }\r\n  $scope.jphide = [];\r\n  $scope.frmempupdt = false;\r\n  $scope.empedtchckbx = false;\r\n\r\n  $scope.deleteEmp = function(emp, idx){\r\n    angular.element('#frmempupdt').appendTo('#empcard');\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/delete_employment_history',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('emp', angular.toJson(data.emp));\r\n        return fd;\r\n      },\r\n      data: {emp: emp}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n      var index = $scope.jpemps.indexOf(emp);\r\n      $scope.jpemps.splice(index, 1);\r\n      \r\n      $timeout(function(){\r\n        $scope.frm3_loader = false;\r\n        if($scope.msg['success']){\r\n          if($scope.msg['success']['emphistory']){\r\n            $scope.success_emp = true;\r\n          }\r\n          $scope.empbtndisable = false;\r\n          $timeout(function(){\r\n            $scope.success_emp = false;\r\n          }, 3500); \r\n        }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['emphistory']){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n          // updating resume\r\n          $scope.updateUsr();\r\n        }\r\n      }\r\n      $scope.empchckbx = $filter('filter')($scope.jpemps, {ispresent: true}).length ? true : false;\r\n      $scope.empedtchckbx = $filter('filter')($scope.jpemps, {ispresent: true}).length ? true : false;\r\n      \r\n      // close pop delete\r\n      $scope.dltemp[idx] = false;\r\n      console.log($scope.msg);\r\n    });\r\n  }\r\n  $scope.removeEmp = function(emp){\r\n    var index = $scope.emps.indexOf(emp);\r\n    $scope.emps.splice(index, 1);\r\n    if($scope.msg['error']){\r\n      if(typeof $scope.msg['error']['emp'] != 'undefined'){\r\n        $scope.msg['error']['emp'].splice(index, 1);\r\n      }\r\n    }\r\n    $scope.empbtndisable = false;\r\n  }\r\n  \r\n  $scope.editEmpForm = function(emp, indx){\r\n    var fltr = $filter('filter')($scope.jpemps, {ispresent: true}).length ? true : false;\r\n    if(fltr == true && emp.ispresent == false){\r\n      $scope.empedtchckbx = true;\r\n    }\r\n    if(emp.ispresent == true){\r\n      $scope.empedtchckbx = false;\r\n    }\r\n    $scope.empedt = emp;\r\n    $scope.empedt_indx = indx;\r\n    var i;\r\n    for (i = 0; i < $scope.jpemps.length; i++) { \r\n      $scope.jphide[i] = false;\r\n    }\r\n    $scope.jphide[indx] = true;\r\n    $scope.frmempupdt = true;\r\n    angular.element('#frmempupdt').appendTo('.empko'+indx);\r\n\r\n    if($scope.msg['error']){\r\n      if(typeof $scope.msg['error']['emp'] != 'undefined'){\r\n        $scope.msg['error']['emp'] = {};\r\n      }\r\n    }\r\n  }\r\n\r\n  $scope.checked = 0;\r\n  $scope.clearEndate = function(index, ispresent, mthd){\r\n    if(ispresent == 1){\r\n      switch(mthd){\r\n        case 'add':\r\n          $scope.emps[index].edate = '';\r\n          break;\r\n        case 'edt':\r\n          $scope.empedt.edate = '';\r\n          break;\r\n      }\r\n      $scope.checked++;\r\n    }else{\r\n      $scope.checked--;\r\n    }\r\n  }\r\n\r\n  $scope.jpchrs = [];\r\n  $scope.chrhide = [];\r\n  $scope.chrs = [];\r\n  $scope.chrbtndisable = false;\r\n  $scope.frmchrupdt = false;\r\n  ChrRef.query().$promise.then(function(data) {\r\n    $scope.jpchrs = data;\r\n    $timeout(function(){\r\n      if($scope.usr){\r\n        if(!$scope.jpchrs.length){\r\n          $scope.chrs = [{\r\n            'chrid'    : $scope.genid(),\r\n            'name'     : \"\",\r\n          }];\r\n        }\r\n      }\r\n    }, 100);\r\n  });\r\n\r\n  $scope.addChar = function(chr){\r\n    $scope.chrs.unshift({\r\n      'chrid'    : $scope.genid(),\r\n      'name'     : \"\",\r\n    });\r\n    if($scope.msg['error']){\r\n      if(typeof $scope.msg['error']['chr'] != \"undefined\"){\r\n        $scope.msg['error']['chr'].splice(0, 0, {});\r\n      }\r\n    }\r\n    if($scope.chrs && $scope.jpchrs){\r\n      if($scope.chrs.length > 2 - $scope.jpchrs.length){\r\n        $scope.chrbtndisable = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  $scope.saveCharRef = function(chr){\r\n    $scope.frm4_loader = true;\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/save_char_ref',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('chr', angular.toJson(data.chr));\r\n        return fd;\r\n      },\r\n      data: {chr: chr}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n      $timeout(function(){\r\n        $scope.frm4_loader = false;\r\n        if($scope.msg['success']){\r\n          if($scope.msg['success']['chrreference']){\r\n            $scope.chrs = [];\r\n            angular.forEach(chr, function(val, key){\r\n              $scope.jpchrs.push({\r\n                'chrid'       : val.chrid,\r\n                'name'        : val.name,\r\n                'company'     : val.company,\r\n                'position'    : val.position,\r\n                'relation'    : val.relation,\r\n                'email'       : val.email,\r\n                'phone'       : val.phone\r\n              });\r\n              $scope.success_chr = true;\r\n              // updating resume\r\n              $scope.updateUsr();\r\n            });\r\n            $timeout(function(){\r\n              $scope.success_chr = false;\r\n            }, 3500); \r\n          }\r\n        }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['chrreference']){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n        }\r\n      }\r\n      console.log($scope.msg);\r\n    });\r\n  }\r\n\r\n  $scope.editChrForm = function(chr, indx){\r\n    $scope.chredt = chr;\r\n    $scope.chredt_indx = indx;\r\n    var i;\r\n    for (i = 0; i < $scope.jpchrs.length; i++) { \r\n      $scope.chrhide[i] = false;\r\n    }\r\n    $scope.chrhide[indx] = true;\r\n    $scope.frmchrupdt = true;\r\n    angular.element('#frmchrupdt').appendTo('.chrko'+indx);\r\n\r\n    if($scope.msg['error']){\r\n      if(typeof $scope.msg['error']['chr'] != 'undefined'){\r\n        $scope.msg['error']['chr'] = {};\r\n      }\r\n    }\r\n  }\r\n\r\n  $scope.removeChr = function(chr){\r\n    var index = $scope.chrs.indexOf(chr);\r\n    $scope.chrs.splice(index, 1);\r\n    if($scope.msg['error']){\r\n      if(typeof $scope.msg['error']['chr'] != 'undefined'){\r\n        $scope.msg['error']['chr'].splice(index, 1);\r\n      }\r\n    }\r\n    $scope.chrbtndisable = false;\r\n  }\r\n\r\n  $scope.updateChrRef = function(idx, chr){\r\n    $scope.frm4_loader = true;\r\n    $http({\r\n        method: 'POST',\r\n        url: '/user/update_char_ref',\r\n        headers: { 'Content-Type': undefined },\r\n        transformRequest: function (data) {\r\n            var fd = new FormData();\r\n            fd.append('chr', angular.toJson(data.chr));\r\n            fd.append('idx', angular.toJson('indx'+data.idx));\r\n            return fd;\r\n        },\r\n        data: {chr: chr, idx: idx}\r\n    }).then(function(result){\r\n        $scope.msg = result.data;\r\n        $timeout(function(){\r\n          $scope.frm4_loader = false;\r\n        }, 200);\r\n        if($scope.msg['success_chr']){\r\n          window.scrollTo('', angular.element(\".chrko\"+idx).offset().top - 60);\r\n          $scope.chrhide[idx] = false;\r\n          $scope.frmchrupdt = false;\r\n\r\n          // updating resume\r\n          $scope.updateUsr();\r\n          $timeout(function(){\r\n            $scope.msg['success_chr'] = null;\r\n          }, 3500);\r\n        }\r\n        console.log($scope.msg);\r\n    });\r\n  }\r\n  $scope.deleteChr = function(chr, idx){\r\n    angular.element('#frmchrupdt').appendTo('#chrcard');\r\n    $http({\r\n      method: 'POST',\r\n      url: '/user/delete_character_ref',\r\n      headers: { 'Content-Type': undefined },\r\n      transformRequest: function (data) {\r\n        var fd = new FormData();\r\n        fd.append('chr', angular.toJson(data.chr));\r\n        return fd;\r\n      },\r\n      data: {chr: chr}\r\n    }).then(function(result){\r\n      $scope.msg = result.data;\r\n      var index = $scope.jpchrs.indexOf(chr);\r\n      $scope.jpchrs.splice(index, 1);\r\n      \r\n      $timeout(function(){\r\n        $scope.frm4_loader = false;\r\n        if($scope.msg['success']){\r\n          if($scope.msg['success']['chrreference']){\r\n            $scope.success_chr = true;\r\n          }\r\n          $scope.chrbtndisable = false;\r\n          $timeout(function(){\r\n            $scope.success_chr = false;\r\n          }, 3500); \r\n        }\r\n      }, 200);\r\n      if($scope.msg['success']){\r\n        if($scope.msg['success']['chrreference']){\r\n          window.scrollTo('', angular.element(\"#edtprof_accrdn\").offset().top);\r\n          // updating resume\r\n          $scope.updateUsr();\r\n        }\r\n      }\r\n      // close pop delete\r\n      $scope.dltchr[idx] = false;\r\n      console.log($scope.msg);\r\n    });\r\n  }\r\n  $scope.showlbl = function(idx, num){\r\n    switch(num){\r\n      case 0:\r\n        $scope.jphide[idx] = false;\r\n        $scope.frmempupdt = false;\r\n        break;\r\n      case 1:\r\n        $scope.chrhide[idx] = false;\r\n        $scope.frmchrupdt = false;\r\n        break;\r\n    }\r\n  }\r\n  $scope.viewResume = function(){\r\n    $('#resume_tpl').appendTo('body').modal().velocity('transition.flipXIn');\r\n  }\r\n  $scope.genid = function() {\r\n    var vrtxt = \"\";\r\n    var vrpossible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n    for (var i = 0; i < 20; i++){\r\n      vrtxt += vrpossible.charAt(Math.floor(Math.random() * vrpossible.length));\r\n    }\r\n    return vrtxt;\r\n  }\r\n\r\n}]);\r\nusrContent.filter('customOrderBy', function () {\r\n   return function (arr) {\r\n\r\n     var numbers = [];\r\n     var strings = [];\r\n       angular.forEach(arr, function(item){\r\n            if(item.ispresent == true ){\r\n              numbers.push(item);     \r\n            }\r\n            else\r\n              strings.push(item);     \r\n          });\r\n\r\n        return numbers.sort().concat(strings);\r\n    };\r\n});\r\nusrContent.directive('fileInput', ['$parse', '$http', '$timeout',\r\n    function($parse, $http, $timeout){\r\n    return {\r\n        restrict: 'A',\r\n        link: function(scope, elm, attrs){\r\n          elm.bind('change', function(){\r\n              \r\n            var files = elm[0].files;\r\n            $parse(attrs.fileInput).assign(scope, files);\r\n            scope.$apply();\r\n            \r\n            scope.shw_avatarmdl = true;\r\n            scope.loader = true;\r\n\r\n            $http({\r\n                method: 'POST',\r\n                url: \"/validate_dp\",\r\n                headers: { 'Content-Type': undefined },\r\n                transformRequest: function (data) {\r\n                    var fd = new FormData();\r\n                    angular.forEach(data.img_files, function(file){\r\n                       fd.append('file', file);\r\n                    });\r\n                    return fd;\r\n                },\r\n                data: {img_files: files}\r\n            }).then(function(result){\r\n                var msg = result.data;\r\n                scope.shw_avatarmdl = false;\r\n                \r\n                if(!msg['dp']['error']['file']){\r\n                    angular.element('#cropModal').appendTo('body').modal({\r\n                        backdrop: 'static'\r\n                    });\r\n                    var file = files[0];\r\n                    (function(file) {\r\n                        var reader = new FileReader();\r\n                        reader.readAsDataURL(file);\r\n                        reader.onload = function(e) {\r\n                            var imgTarget = e.target.result;\r\n                            scope.imgForm(imgTarget);\r\n                        }\r\n                    }(file));\r\n                    scope.msg = '';\r\n                }else{\r\n                    scope.msg = msg;\r\n                }\r\n            });\r\n          });\r\n        }\r\n    }\r\n}]);\r\n\r\nusrContent.directive('fileResume', ['$parse', '$http', '$timeout',\r\n    function($parse, $http, $timeout){\r\n    return {\r\n        restrict: 'A',\r\n        link: function(scope, elm, attrs){\r\n            elm.bind('change', function(){\r\n                var files = elm[0].files;\r\n                $parse(attrs.fileResume).assign(scope, files);\r\n                scope.$apply();\r\n                \r\n                scope.resume_loader = true;\r\n\r\n                $http({\r\n                    method: 'POST',\r\n                    url: \"/upload_resume\",\r\n                    headers: { 'Content-Type': undefined },\r\n                    transformRequest: function (data) {\r\n                        var fd = new FormData();\r\n                        angular.forEach(data.resumefiles, function(file){\r\n                           fd.append('file', file);\r\n                        });\r\n                        return fd;\r\n                    },\r\n                    data: {resumefiles: files}\r\n                }).then(function(result){\r\n                    var msg = result.data;\r\n                    console.log(msg);\r\n                    $timeout(function(){\r\n                        scope.resume_loader = false;\r\n                        scope.updateUsr();\r\n                        if(!msg['resume']){\r\n                            scope.msg = '';\r\n                        }else{\r\n                            scope.msg = msg;\r\n                        }\r\n                        angular.element('.preview_resume .upload').val('');\r\n                        \r\n                    }, 500);\r\n                });\r\n            });\r\n        }\r\n    }\r\n}]);\r\n\r\n\r\nusrContent.directive('jpCustomCrop', ['$parse', '$rootScope', '$timeout', function($parse, $rootScope, $timeout){\r\n    return {\r\n      restrict: 'A',\r\n      link: function (scope, element, attrs)\r\n      {\r\n        $(function(){\r\n            $('#cropModal').on('shown.bs.modal', function () {\r\n                \r\n                $timeout(function(){\r\n                    scope.loader = false;\r\n                    $('.imgcropper, .prvw').hide().delay('200').fadeIn();\r\n                }, 1000)\r\n              var jcrop_api,\r\n              boundx,\r\n              boundy,\r\n\r\n              // Grab some information about the preview pane\r\n              $preview = $('.preview-pane'),\r\n              $pcnt = $('.preview-pane .preview-container'),\r\n              $pimg = $('.preview-pane .preview-container img'),\r\n              xsize = $pcnt.width(),\r\n              ysize = $pcnt.height();\r\n              \r\n              $('#target').Jcrop({\r\n                boxWidth: 670,\r\n                // boxHeight: 550,\r\n                minSize: [ 100, 100 ],\r\n                // maxSize: [ 450, 450 ],\r\n                onChange: updatePreview,\r\n                onSelect: updatePreview,\r\n                aspectRatio: xsize / ysize\r\n              },function(){\r\n                // Use the API to get the real image size\r\n                var bounds = this.getBounds();\r\n                boundx = bounds[0];\r\n                boundy = bounds[1];\r\n                \r\n                // Store the API in the jcrop_api variable\r\n                jcrop_api = this;\r\n                jcrop_api.animateTo([510, 300, 190, 100]);\r\n              });\r\n\r\n                function updatePreview(c){\r\n                    var imgx = Math.round(c.x);\r\n                    var imgy = Math.round(c.y);\r\n                    var imgw = Math.round(c.w);\r\n                    var imgh = Math.round(c.h);\r\n                    var imgw2 = xsize;\r\n                    var imgh2 = ysize;\r\n                    scope.img_coordinates({imgx: imgx, imgy: imgy, imgw: imgw, imgh: imgh, imgw2: imgw2, imgh2: imgh2});\r\n                    if (parseInt(c.w) > 0){\r\n                      var rx = xsize / c.w;\r\n                      var ry = ysize / c.h;\r\n                      $pimg.css({\r\n                        width: Math.round(rx * boundx) + 'px',\r\n                        height: Math.round(ry * boundy) + 'px',\r\n                        marginLeft: '-' + Math.round(rx * c.x) + 'px',\r\n                        marginTop: '-' + Math.round(ry * c.y) + 'px'\r\n                      });\r\n                    }\r\n                };\r\n            })\r\n        });\r\n      }\r\n    };\r\n}]);\r\nusrContent.directive('currencyInput', [function () {\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attrs, ngModel) {\r\n            attrs.$set('ngTrim', \"false\");\r\n\r\n            var formatter = function(str, isNum) {\r\n                str = String( Number(str || 0) / (isNum?1:100) );\r\n                str = (str=='0'?'0.0':str).split('.');\r\n                str[1] = str[1] || '0';\r\n                return str[0].replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, '$1,') + '.' + (str[1].length==1?str[1]+'0':str[1]);\r\n            }\r\n            var updateView = function(val) {\r\n                scope.$applyAsync(function () {\r\n                    ngModel.$setViewValue(val || '');\r\n                    ngModel.$render();\r\n                });\r\n            }\r\n            var parseNumber = function(val) {\r\n                var modelString = formatter(ngModel.$modelValue, true);\r\n                var sign = {\r\n                    pos: /[+]/.test(val),\r\n                    neg: /[-]/.test(val)\r\n                }\r\n                sign.has = sign.pos || sign.neg;\r\n                sign.both = sign.pos && sign.neg;\r\n\r\n                if (!val || sign.has && val.length==1 || ngModel.$modelValue && Number(val)===0) {\r\n                    var newVal = (!val || ngModel.$modelValue && Number()===0?'':val);\r\n                    if (ngModel.$modelValue !== newVal)\r\n                        updateView(newVal);\r\n\r\n                    return '';\r\n                }\r\n                else {\r\n                    var valString = String(val || '');\r\n                    var newSign = (sign.both && ngModel.$modelValue>=0 || !sign.both && sign.neg?'-':'');\r\n                    var newVal = valString.replace(/[^0-9]/g,'');\r\n                    var viewVal = newSign + formatter(angular.copy(newVal));\r\n\r\n                    if (modelString !== valString)\r\n                        updateView(viewVal);\r\n\r\n                    return (Number(newSign + newVal) / 100) || 0;\r\n                }\r\n            }\r\n            var formatNumber = function(val) {\r\n                if (val) {\r\n                    var str = String(val).split('.');\r\n                    str[1] = str[1] || '0';\r\n                    val = str[0] + '.' + (str[1].length==1?str[1]+'0':str[1]);\r\n                }\r\n                return parseNumber(val);\r\n            }\r\n\r\n            ngModel.$parsers.push(parseNumber);\r\n            ngModel.$formatters.push(formatNumber);\r\n        }\r\n    };\r\n}]);//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9yZXNvdXJjZXMvYXNzZXRzL2pzL2FwcC91c2VyL2VkaXRfcHJvZmlsZS5qcz8wYzNkIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JzsgXHJcbnZhciB1c3JDb250ZW50ID0gYW5ndWxhci5tb2R1bGUoJ3VzckNvbnRlbnQnLCBbJ3N1bW1lcm5vdGUnLCAndWkubWFzaycsICdBeGVsU29mdCddKTtcclxuXHJcbnVzckNvbnRlbnQuY29udHJvbGxlcignY3RybEVkaXRQcm9maWxlJyxcclxuICAgIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGZpbHRlcicsICckdGltZW91dCcsICckaHR0cCcsICckcScsICdVc3InLCAnQ291bnRyaWVzJywgJ1BlcnNubEluZm8nLCAnRWR1Y0JnJywgJ0VtcEhpc3RvcnknLCAnQ2hyUmVmJywgJ1Byb2ZGb3JtcycsXHJcbiAgICBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICRmaWx0ZXIsICR0aW1lb3V0LCAkaHR0cCwgJHEsIFVzciwgQ291bnRyaWVzLCBQZXJzbmxJbmZvLCBFZHVjQmcsIEVtcEhpc3RvcnksIENoclJlZiwgUHJvZkZvcm1zKSB7XHJcblxyXG4gICRzY29wZS5wcm9mb3JtID0gUHJvZkZvcm1zLnF1ZXJ5KCk7XHJcbiAgJHNjb3BlLmZybTFfbG9hZGVyID0gZmFsc2U7XHJcbiAgJHNjb3BlLmZybTJfbG9hZGVyID0gZmFsc2U7XHJcbiAgJHNjb3BlLmZybTNfbG9hZGVyID0gZmFsc2U7XHJcbiAgUHJvZkZvcm1zLnF1ZXJ5KCkuJHByb21pc2UudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICRzY29wZS5wcm9mb3JtID0gZGF0YTtcclxuICAgICAgdmFyIGFjdHZmcm0gPSAwLFxyXG4gICAgICAgICAgYWN0dmZybTIgPSAwLFxyXG4gICAgICAgICAgYWN0dmZybTMgPSAwLFxyXG4gICAgICAgICAgYWN0dmZybTQgPSAwO1xyXG4gICAgICBzd2l0Y2goZGF0YVsncGVyc29uYWxpbmZvJ10pe1xyXG4gICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgIGFjdHZmcm0gPSAxO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgYWN0dmZybSA9IDA7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBzd2l0Y2goZGF0YVsnZWR1Y2F0aW9uYWxiZyddKXtcclxuICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICBhY3R2ZnJtMiA9IDE7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgYWN0dmZybTIgPSAwO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIHN3aXRjaChkYXRhWydlbXBoaXN0b3J5J10pe1xyXG4gICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgIGFjdHZmcm0zID0gMTtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICBhY3R2ZnJtMyA9IDA7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgc3dpdGNoKGRhdGFbJ2NoYXJyZWZlcmVuY2UnXSl7XHJcbiAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgYWN0dmZybTQgPSAxO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgIGFjdHZmcm00ID0gMDtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgaWYoZGF0YVsncGVyc29uYWxpbmZvJ10gJiYgIWRhdGFbJ2VkdWNhdGlvbmFsYmcnXSl7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmNvbGxhcHNlVGFiKDIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYoZGF0YVsncGVyc29uYWxpbmZvJ10gJiYgZGF0YVsnZWR1Y2F0aW9uYWxiZyddICYmICFkYXRhWydlbXBoaXN0b3J5J10pe1xyXG4gICAgICAgICAgICAgICRzY29wZS5jb2xsYXBzZVRhYigzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmKGRhdGFbJ3BlcnNvbmFsaW5mbyddICYmIGRhdGFbJ2VkdWNhdGlvbmFsYmcnXSAmJiBkYXRhWydlbXBoaXN0b3J5J10gJiYgIWRhdGFbJ2NoYXJyZWZlcmVuY2UnXSl7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmNvbGxhcHNlVGFiKDQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9LCAyMDApO1xyXG4gICAgICAkc2NvcGUuZm9ybXMgPSBbXHJcbiAgICAgICAgICB7J2Zvcm0nOiAgJ1BlcnNvbmFsSW5mbycsICdjYXJkbnVtJzogMCwgJ2FjdHZmb3JtJzogYWN0dmZybX0sXHJcbiAgICAgICAgICB7J2Zvcm0nOiAgJ0VkdWNhdGlvbmFsQmcnLCAnY2FyZG51bSc6IDEsICdhY3R2Zm9ybSc6IGFjdHZmcm0yfSxcclxuICAgICAgICAgIHsnZm9ybSc6ICAnRW1wbG95bWVudEhpc3RvcnknLCAnY2FyZG51bSc6IDEsICdhY3R2Zm9ybSc6IGFjdHZmcm0zfSxcclxuICAgICAgICAgIHsnZm9ybSc6ICAnQ2hhcmFjdGVyUmVmZXJlbmNlJywgJ2NhcmRudW0nOiAxLCAnYWN0dmZvcm0nOiBhY3R2ZnJtNH1cclxuICAgICAgXTtcclxuICB9KTtcclxuICBcclxuICAkc2NvcGUub3BlbkZvcm0gPSBmdW5jdGlvbihjYXJkbnVtLCBjYXJkKXtcclxuICAgIHN3aXRjaChjYXJkKXtcclxuICAgICAgY2FzZSAwOlxyXG4gICAgICAgICRzY29wZS5mb3Jtc1tjYXJkbnVtXVsnYWN0dmZvcm0nXSA9IDA7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMTpcclxuICAgICAgICAkc2NvcGUuZm9ybXNbY2FyZG51bV1bJ2FjdHZmb3JtJ10gPSAxO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgLy8gY29uc29sZS5sb2coY2FyZCk7XHJcbiAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgICRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSA9ICcnO1xyXG4gICAgfVxyXG4gICAgdmFyIGZhZGVmcm0gPSBjYXJkbnVtKzE7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoJy5jYXJkOm50aC1jaGlsZCgnK2ZhZGVmcm0rJykgLmNyZGJkeScpLmhpZGUoKS5kZWxheSgyMDApLmZhZGVJbigpO1xyXG4gIH1cclxuICAkc2NvcGUudXBkYXRlVXNyID0gZnVuY3Rpb24oKXtcclxuICAgIFVzci5xdWVyeSgpLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICRyb290U2NvcGUudXNyID0gZGF0YTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAkc2NvcGUubXNnID0gW107XHJcbiAgJHNjb3BlLmNvdW50cmllcyA9IENvdW50cmllcy5xdWVyeSgpO1xyXG4gICRzY29wZS5mcm0xID0gW107XHJcbiAgJHNjb3BlLmZybXgxID0gZmFsc2U7XHJcbiAgJHNjb3BlLmZybXgyID0gZmFsc2U7XHJcbiAgUGVyc25sSW5mby5xdWVyeSgpLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgJHNjb3BlLmZybTEgPSBkYXRhWzBdO1xyXG4gICAgJHNjb3BlLmZybXgxID0gZGF0YS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XHJcbiAgICBpZigkc2NvcGUuZnJtMSl7XHJcbiAgICAgICRzY29wZS5jdmxzdGF0dXMgPSAkc2NvcGUuZnJtMS5jc3RhdHVzO1xyXG4gICAgICAkc2NvcGUuY291bnRyeSA9ICRzY29wZS5mcm0xLmNvdW50cnk7XHJcbiAgICAgICRzY29wZS5uYXRpb25hbGl0eSA9ICRzY29wZS5mcm0xLm5hdGlvbmFsaXR5O1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkc2NvcGUuc2VsZWN0X3N0YXR1cyA9IHtcclxuICAgIG9uU2VsZWN0OiBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAkc2NvcGUuZnJtMS5jc3RhdHVzID0gaXRlbS5pZDtcclxuICAgIH1cclxuICB9O1xyXG4gICRzY29wZS5zZWxlY3RfY291bnRyeSA9IHtcclxuICAgIG9uU2VsZWN0OiBmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAkc2NvcGUuZnJtMS5jb3VudHJ5ID0gaXRlbS5pZDtcclxuICAgIH1cclxuICB9O1xyXG4gICRzY29wZS5zZWxlY3RfbmF0aW9uYWxpdHkgPSB7XHJcbiAgICBvblNlbGVjdDogZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgJHNjb3BlLmZybTEubmF0aW9uYWxpdHkgPSBpdGVtLmlkO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgJHNjb3BlLmNzdGF0dXMgPSBbXHJcbiAgICAgIHtpZDogMSwgbmFtZTogJ1NpbmdsZSd9LFxyXG4gICAgICB7aWQ6IDIsIG5hbWU6ICdNYXJyaWVkJ30sXHJcbiAgICAgIHtpZDogMywgbmFtZTogJ0xlZ2FsbHkgc2VwYXJhdGVkJ30sXHJcbiAgICAgIHtpZDogNCwgbmFtZTogJ0FubnVsbGVkJ30sXHJcbiAgICAgIHtpZDogNSwgbmFtZTogJ1dpZG93J30sXHJcbiAgICAgIHtpZDogNiwgbmFtZTogJ1dpZG93ZXInfVxyXG4gIF07XHJcblxyXG4gICRzY29wZS5pbWdGb3JtID0gZnVuY3Rpb24oaW1ndGFyZ2V0KXtcclxuICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICRzY29wZS5pbWd0YXJnZXQgPSBpbWd0YXJnZXQ7XHJcbiAgICB9LCAxMCk7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuaW1nX2Nvb3JkaW5hdGVzID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMpe1xyXG4gICAgJHNjb3BlLmNvb3JkaW5hdGVzID0gY29vcmRpbmF0ZXM7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuY2FuY2VsVXBsb2FkID0gZnVuY3Rpb24oKXtcclxuICAgICRzY29wZS5pbWd0YXJnZXQgPSAnJztcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgnLnVwbG9hZCcpLnZhbCgnJyk7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoJyN0YXJnZXQnKS5kYXRhKCdKY3JvcCcpLmRlc3Ryb3koKTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgnI3RhcmdldCcpLmF0dHIoJ3NyYycsICcnKTtcclxuICB9XHJcblxyXG4gICRzY29wZS51cGxvYWRGaWxlID0gZnVuY3Rpb24oZmlsZXMpe1xyXG4gICAgJGh0dHAoe1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgdXJsOiAnL3VwbG9hZF9kcCcsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6IHVuZGVmaW5lZCB9LFxyXG4gICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBmZCA9IG5ldyBGb3JtRGF0YSgpO1xyXG5cclxuICAgICAgICBmZC5hcHBlbmQoJ2Nvb3JkaW5hdGVzJywgYW5ndWxhci50b0pzb24oZGF0YS5jb29yZGluYXRlcykpO1xyXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLmltZ19maWxlcywgZnVuY3Rpb24oZmlsZSl7XHJcbiAgICAgICAgICAgZmQuYXBwZW5kKCdmaWxlJywgZmlsZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGZkO1xyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiB7aW1nX2ZpbGVzOiBmaWxlcywgY29vcmRpbmF0ZXM6ICRzY29wZS5jb29yZGluYXRlc31cclxuICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgY29uc29sZS5sb2cocmVzdWx0LmRhdGEpO1xyXG4gICAgICBcclxuICAgICAgdmFyIG1zZyA9IHJlc3VsdC5kYXRhO1xyXG5cclxuICAgICAgaWYoIW1zZ1snZHAnXVsnc3VjY2VzcyddKXtcclxuICAgICAgICAgICRzY29wZS5tc2cgPSAnJztcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAkc2NvcGUubXNnID0gbXNnO1xyXG4gICAgICAgICAgJHNjb3BlLnVwZGF0ZVVzcigpO1xyXG4gICAgICAgICAgJHNjb3BlLnRpbWVzdGFtcCgpO1xyXG4gICAgICAgICAgJHNjb3BlLmNhbmNlbFVwbG9hZCgpO1xyXG4gICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjY3JvcE1vZGFsJykubW9kYWwoJ2hpZGUnKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgJHNjb3BlLmRlbGV0ZVJlY29yZCA9IGZ1bmN0aW9uKG51bSl7XHJcbiAgICAkaHR0cCh7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICB1cmw6ICcvZGVsZXRlX3JlY29yZCcsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6IHVuZGVmaW5lZCB9LFxyXG4gICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBmZCA9IG5ldyBGb3JtRGF0YSgpO1xyXG5cclxuICAgICAgICBmZC5hcHBlbmQoJ251bScsIGFuZ3VsYXIudG9Kc29uKGRhdGEubnVtKSk7XHJcbiAgICAgICAgcmV0dXJuIGZkO1xyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiB7bnVtOiBudW19XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgIHZhciBtc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgdmFyIG1zZ19kdGwgPSBbXTtcclxuICAgICAgaWYobXNnWydkcGltZyddKXtcclxuICAgICAgICBtc2dfZHRsID0gbXNnWydkcGltZyddWydkbHQnXVsnc3VjY2VzcyddO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKG1zZ1sncnNtJ10pe1xyXG4gICAgICAgIG1zZ19kdGwgPSBtc2dbJ3JzbSddWydkbHQnXVsnc3VjY2VzcyddO1xyXG4gICAgICB9XHJcbiAgICAgIGlmKCFtc2dfZHRsKXtcclxuICAgICAgICAkc2NvcGUubXNnID0gJyc7XHJcbiAgICAgIH1lbHNle1xyXG4gICAgICAgICRzY29wZS5tc2cgPSBtc2c7XHJcbiAgICAgICAgJHJvb3RTY29wZS51c3IgPSBVc3IucXVlcnkoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gICRzY29wZS5kbHRlbXAgPSBbXTtcclxuICAkc2NvcGUuZGx0Y2hyID0gW107XHJcbiAgJHNjb3BlLmNsc2JibCA9IGZ1bmN0aW9uKG51bSwgaW5kZXgpe1xyXG4gICAgc3dpdGNoKG51bSl7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICAkc2NvcGUuZGx0ZHAgPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgICRzY29wZS5kbHRyc20gPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAyOlxyXG4gICAgICAgICRzY29wZS5mcm0xY25mcm0gPSBmYWxzZTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnZGx0ZW1wJzpcclxuICAgICAgICAkc2NvcGUuZGx0ZW1wW2luZGV4XSA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdkbHRjaHInOlxyXG4gICAgICAgICRzY29wZS5kbHRjaHJbaW5kZXhdID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhbmd1bGFyLmVsZW1lbnQoJyNlZHRwcm9mX2FjY3JkbiAuY2FyZDpudGgtY2hpbGQoMSkgLmNvbGxhcHNlJykuY29sbGFwc2UoJ3Nob3cnKTtcclxuICBhbmd1bGFyLmVsZW1lbnQoJyNlZHRwcm9mX2FjY3JkbiAuY2FyZCAuY2FyZC1oZWFkZXInKS5hZGRDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgYW5ndWxhci5lbGVtZW50KCcjZWR0cHJvZl9hY2NyZG4gLmNhcmQ6bnRoLWNoaWxkKDEpIC5jYXJkLWhlYWRlcicpLnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICBhbmd1bGFyLmVsZW1lbnQoJyNlZHRwcm9mX2FjY3JkbiAuY2FyZCAuY29sbGFwc2UnKS5jb2xsYXBzZSgnaGlkZScpO1xyXG4gIHZhciBjdXJyZW50X251bSA9IDE7XHJcblxyXG4gICRzY29wZS5jb2xsYXBzZVRhYiA9IGZ1bmN0aW9uKG51bSl7XHJcbiAgICBpZighYW5ndWxhci5lbGVtZW50KCcjZWR0cHJvZl9hY2NyZG4gLmNhcmQ6bnRoLWNoaWxkKCcrbnVtKycpJykuaGFzQ2xhc3MoJ2Rpc2FibGVkJykpe1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJyNlZHRwcm9mX2FjY3JkbiAuY2FyZCAuY29sbGFwc2UnKS5jb2xsYXBzZSgnaGlkZScpO1xyXG4gICAgICBhbmd1bGFyLmVsZW1lbnQoJyNlZHRwcm9mX2FjY3JkbiAuY2FyZDpudGgtY2hpbGQoJytudW0rJykgLmNvbGxhcHNlJykuY29sbGFwc2UoJ3Nob3cnKTtcclxuICAgICAgXHJcbiAgICAgIGlmKGN1cnJlbnRfbnVtID09IG51bSl7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjZWR0cHJvZl9hY2NyZG4gLmNhcmQ6bnRoLWNoaWxkKCcrbnVtKycpIC5jYXJkLWhlYWRlcicpLnRvZ2dsZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgfWVsc2V7XHJcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjZWR0cHJvZl9hY2NyZG4gLmNhcmQgLmNhcmQtaGVhZGVyJykuYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnI2VkdHByb2ZfYWNjcmRuIC5jYXJkOm50aC1jaGlsZCgnK251bSsnKSAuY2FyZC1oZWFkZXInKS50b2dnbGVDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgIH1cclxuICAgICAgY3VycmVudF9udW0gPSBudW07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuc3VtbWVybm90ZV9vcHRpb25zID0ge1xyXG4gICAgdG9vbGJhcjogW1xyXG4gICAgICBbJ2VkaXQnLFsndW5kbycsJ3JlZG8nXV0sXHJcbiAgICAgIFsnc3R5bGUnLCBbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZSddXSxcclxuICAgICAgWydhbGlnbm1lbnQnLCBbJ3VsJywgJ29sJywgJ3BhcmFncmFwaCcsICdsaW5laGVpZ2h0J11dXHJcbiAgICAgICAgICAgIFxyXG4gICAgXVxyXG4gIH07XHJcbiAgJHNjb3BlLm1ha2VTYW1lQWRkcmVzcyA9IGZ1bmN0aW9uKGNoZWNrLCBmcm0xKXtcclxuICAgIGlmKGNoZWNrID09IHRydWUpe1xyXG4gICAgICAkc2NvcGUuZnJtMSA9IGZybTE7XHJcbiAgICAgICRzY29wZS5mcm0xLnBlcm1hbmVudF9hZGRyZXNzID0gYW5ndWxhci5jb3B5KCRzY29wZS5mcm0xLnByZXNlbnRfYWRkcmVzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gICRzY29wZS5zdWNjZXNzX3Byc25sID0gZmFsc2U7XHJcbiAgJHNjb3BlLnN1Y2Nlc3NfZWR1YyA9IGZhbHNlO1xyXG4gICRzY29wZS5zdWNjZXNzX2VtcCA9IGZhbHNlO1xyXG4gICRzY29wZS5zdWNjZXNzX2NociA9IGZhbHNlO1xyXG4gICRzY29wZS5zYXZlUGVyc29uYWxJbmZvID0gZnVuY3Rpb24oZnJtdXNyKXtcclxuICAgICRzY29wZS5mcm0xX2xvYWRlciA9IHRydWU7XHJcbiAgICAkaHR0cCh7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICB1cmw6ICcvdXNlci9zYXZlX3BlcnNvbmFsX2luZm8nLFxyXG4gICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcclxuICAgICAgdHJhbnNmb3JtUmVxdWVzdDogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgZmQgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICBmZC5hcHBlbmQoJ2ZybXVzcicsIGFuZ3VsYXIudG9Kc29uKGRhdGEuZnJtdXNyKSk7XHJcbiAgICAgICAgcmV0dXJuIGZkO1xyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiB7ZnJtdXNyOiBmcm11c3J9XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgICRzY29wZS5tc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgaWYoISRzY29wZS5tc2dbJ2Vycm9yJ10pe1xyXG4gICAgICAgICRzY29wZS5mb3Jtc1swXVsnYWN0dmZvcm0nXSA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgYW5ndWxhci5lbGVtZW50KCcuY2FyZDpudGgtY2hpbGQoMSkgLmNyZGJkeScpLmhpZGUoKS5kZWxheSgyMDApLmZhZGVJbigpO1xyXG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICRzY29wZS5mcm0xX2xvYWRlciA9IGZhbHNlO1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ11bJ3Byc25sJ11bJ2FkZGVkJ10pe1xyXG4gICAgICAgICAgICAkc2NvcGUuZnJteDEgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUuY29sbGFwc2VUYWIoMik7XHJcbiAgICAgICAgICAgICRzY29wZS5wcm9mb3JtWydwZXJzb25hbGluZm8nXSA9IDE7XHJcbiAgICAgICAgICAgIC8vIHVwZGF0aW5nIHJlc3VtZVxyXG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlVXNyKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19wcnNubCA9IHRydWU7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19wcnNubCA9IGZhbHNlO1xyXG4gICAgICAgICAgfSwgMzUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAyMDApO1xyXG4gICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXVsncHJzbmwnXSl7XHJcbiAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oJycsIGFuZ3VsYXIuZWxlbWVudChcIiNlZHRwcm9mX2FjY3JkblwiKS5vZmZzZXQoKS50b3ApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmxvZygkc2NvcGUubXNnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAkc2NvcGUuanBlbXBzID0gW107XHJcbiAgJHNjb3BlLmVtcGJ0bmRpc2FibGUgPSBmYWxzZTtcclxuICAkc2NvcGUuY2hlY2tfZW1wcyA9IGZ1bmN0aW9uKCl7XHJcbiAgICBpZigkc2NvcGUuZW1wcyAmJiAkc2NvcGUuanBlbXBzKXtcclxuICAgICAgaWYoJHNjb3BlLmVtcHMubGVuZ3RoID4gMyAtICRzY29wZS5qcGVtcHMubGVuZ3RoKXtcclxuICAgICAgICAkc2NvcGUuZW1wYnRuZGlzYWJsZSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgRW1wSGlzdG9yeS5xdWVyeSgpLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgJHNjb3BlLmpwZW1wcyA9IGRhdGE7XHJcbiAgICAkc2NvcGUuZW1wY2hja2J4ID0gJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmpwZW1wcywge2lzcHJlc2VudDogdHJ1ZX0pLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcclxuICAgIHZhciBub3dvcmtleHBybmNlID0gJHNjb3BlLmpwZW1wcy5sZW5ndGggPyB0cnVlIDogZmFsc2U7XHJcbiAgICAkc2NvcGUuY2hlY2tfZW1wcygpO1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgaWYoJHNjb3BlLmZybTEpe1xyXG4gICAgICAgICRzY29wZS53cmtleHBlcmllbmNlID0gJHNjb3BlLmZybTEud3JrZXhwZXJpZW5jZTtcclxuICAgICAgICBpZighJHNjb3BlLmpwZW1wcy5sZW5ndGggJiYgJHNjb3BlLmZybTEud3JrZXhwZXJpZW5jZSA+IDEpe1xyXG4gICAgICAgICAgJHNjb3BlLmVtcHMgPSBbe1xyXG4gICAgICAgICAgICAnZW1waWQnICAgICAgICAgIDogJHNjb3BlLmdlbmlkKCksXHJcbiAgICAgICAgICAgICdjb21wYW55JyAgICAgICAgOiBcIlwiLFxyXG4gICAgICAgICAgICAncG9zaXRpb24nICAgICAgIDogXCJcIixcclxuICAgICAgICAgICAgJ3NhbGFyeScgICAgICAgICA6IFwiXCIsXHJcbiAgICAgICAgICAgICdzZGF0ZScgICAgICAgICAgOiBcIlwiLFxyXG4gICAgICAgICAgICAnZWRhdGUnICAgICAgICAgIDogXCJcIixcclxuICAgICAgICAgICAgJ2lzcHJlc2VudCcgICAgICA6IFwiXCIsXHJcbiAgICAgICAgICAgICdqYmRlc2NyaXB0aW9uJyAgOiBcIjx1bD48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48L3VsPlwiLFxyXG4gICAgICAgICAgICAncmVhc29uZm9ybGVhdmluZycgOiBcIjx1bD48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48L3VsPlwiXHJcbiAgICAgICAgICB9XTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sIDEwMCk7XHJcbiAgICAkc2NvcGUueXJzeHBybmNzID0gW1xyXG4gICAgICAgIHtpZDogMSwgbmFtZTogJ05vIFdvcmsgRXhwZXJpZW5jZScsIGRpc2FibGVkOiBub3dvcmtleHBybmNlfSxcclxuICAgICAgICB7aWQ6IDIsIG5hbWU6ICcxLTMgWXJzLiBvZiBFeHBlcmllbmNlJywgZGlzYWJsZWQ6IGZhbHNlfSxcclxuICAgICAgICB7aWQ6IDMsIG5hbWU6ICc0LTYgWXJzLiBvZiBFeHBlcmllbmNlJywgZGlzYWJsZWQ6IGZhbHNlfSxcclxuICAgICAgICB7aWQ6IDQsIG5hbWU6ICc3IHlycy4gYW5kIEFib3ZlJywgZGlzYWJsZWQ6IGZhbHNlfVxyXG4gICAgXTtcclxuICB9KTtcclxuICAvLyAkc2NvcGUuanBlbXBzID0gW107XHJcbiAgJHNjb3BlLm1zZ1snZXJyb3InXSA9IFtdO1xyXG4gICRzY29wZS5zY2hsID0ge1xyXG4gICAgICAnbmFtZScgICAgICAgIDogXCJcIixcclxuICAgICAgJ2NvdXJzZScgICAgICA6IFwiXCIsXHJcbiAgICAgICdzZGF0ZScgICAgICAgOiBcIlwiLFxyXG4gICAgICAnZWRhdGUnICAgICAgIDogXCJcIixcclxuICAgICAgJ2F3YXJkc3JlY29nbml0aW9uJyAgOiBcIjx1bD48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48L3VsPlwiXHJcbiAgICB9O1xyXG4gIEVkdWNCZy5xdWVyeSgpLiRwcm9taXNlLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgJHNjb3BlLnNjaGwgPSBkYXRhLmxlbmd0aCA/IGRhdGFbMF0gOiAkc2NvcGUuc2NobDtcclxuICAgICRzY29wZS5mcm14MiA9IGRhdGEubGVuZ3RoID8gdHJ1ZSA6IGZhbHNlO1xyXG4gIH0pO1xyXG4gICRzY29wZS5zYXZlRWR1Y0JnID0gZnVuY3Rpb24oc2NobCl7XHJcbiAgICAkc2NvcGUuZnJtMl9sb2FkZXIgPSB0cnVlO1xyXG4gICAgJGh0dHAoe1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgdXJsOiAnL3VzZXIvc2F2ZV9lZHVjYXRpb25hbF9iZycsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6IHVuZGVmaW5lZCB9LFxyXG4gICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBmZCA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgIGZkLmFwcGVuZCgnc2NobCcsIGFuZ3VsYXIudG9Kc29uKGRhdGEuc2NobCkpO1xyXG4gICAgICAgIHJldHVybiBmZDtcclxuICAgICAgfSxcclxuICAgICAgZGF0YToge3NjaGw6IHNjaGx9XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgICRzY29wZS5tc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgaWYoISRzY29wZS5tc2dbJ2Vycm9yJ10pe1xyXG4gICAgICAgICRzY29wZS5mb3Jtc1sxXVsnYWN0dmZvcm0nXSA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgYW5ndWxhci5lbGVtZW50KCcuY2FyZDpudGgtY2hpbGQoMikgLmNyZGJkeScpLmhpZGUoKS5kZWxheSgyMDApLmZhZGVJbigpO1xyXG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgJHNjb3BlLmZybTJfbG9hZGVyID0gZmFsc2U7XHJcbiAgICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ11bJ2VkdWNiZyddWydhZGRlZCddKXtcclxuICAgICAgICAgICAgICAkc2NvcGUuY29sbGFwc2VUYWIoMyk7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnByb2Zvcm1bJ2VkdWNhdGlvbmFsYmcnXSA9IDE7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLmZybXgyID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19lZHVjID0gdHJ1ZTtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19lZHVjID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sIDM1MDApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9LCAyMDApO1xyXG4gICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXVsnZWR1Y2JnJ10pe1xyXG4gICAgICAgICAgd2luZG93LnNjcm9sbFRvKCcnLCBhbmd1bGFyLmVsZW1lbnQoXCIjZWR0cHJvZl9hY2NyZG5cIikub2Zmc2V0KCkudG9wKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLm1zZyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gICRzY29wZS5jdXJyZW5jaWVzID0gW1xyXG4gICAgICB7IGlkOiAxLCBuYW1lOiAnVVNEICQnIH0sXHJcbiAgICAgIHsgaWQ6IDIsIG5hbWU6ICdQaHAg4oKxJyB9XHJcbiAgXTtcclxuICBcclxuICAkc2NvcGUuZ2V0QWdlID0gZnVuY3Rpb24oYmRheSl7XHJcbiAgICB2YXIgY3VycmVudF9kYXRlICAgID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBjdXJyZW50X3lyICAgICAgPSBjdXJyZW50X2RhdGUuZ2V0RnVsbFllYXIoKTtcclxuICAgIHZhciBjdXJyZW50X21vICAgICAgPSBjdXJyZW50X2RhdGUuZ2V0TW9udGgoKTtcclxuXHJcbiAgICB2YXIgYmRhdGUgICAgICAgICAgID0gbmV3IERhdGUoYmRheSk7XHJcbiAgICBpZiAoIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChiZGF0ZSkgPT09IFwiW29iamVjdCBEYXRlXVwiICkge1xyXG4gICAgICBpZiAoIWlzTmFOKGJkYXRlLmdldFRpbWUoKSkpe1xyXG4gICAgICAgIHZhciBiZGF0ZV95ciAgICAgICAgPSBiZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgIHZhciBiZGF0ZV9tbyAgICAgICAgPSBiZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgIHZhciB5b3VyX3lyICAgICAgICAgPSBjdXJyZW50X3lyIC0gYmRhdGVfeXI7XHJcbiAgICAgICAgdmFyIHlvdXJfbW8gICAgICAgICA9IGN1cnJlbnRfbW8gLSBiZGF0ZV9tbztcclxuICAgICAgICBpZih5b3VyX21vIDwgMCB8fCAoeW91cl9tbyA9PT0gMCAmJiBjdXJyZW50X2RhdGUuZ2V0RGF0ZSgpIDwgYmRhdGUuZ2V0RGF0ZSgpKSl7XHJcbiAgICAgICAgICAgIHlvdXJfeXItLTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS5mcm0xLmFnZSA9IHlvdXJfeXI7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJHNjb3BlLmZybTEuYWdlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmdlbmRlciA9IFtcclxuICAgIHtpZDogMSwgbmFtZTogJ0ZlbWFsZSd9LFxyXG4gICAge2lkOiAyLCBuYW1lOiAnTWFsZSd9XHJcbiAgXTtcclxuXHJcbiAgdmFyIGZsdHIgPSAnJztcclxuICAkc2NvcGUuZ2V0Zmx0cnZhbHVlID0gZnVuY3Rpb24oYXJyLCBhcnJfaWQsIGlkbnRmcil7XHJcbiAgICBpZigkZmlsdGVyKCdmaWx0ZXInKShhcnIsIHtpZDogYXJyX2lkfSlbMF0pe1xyXG4gICAgICBzd2l0Y2goaWRudGZyKXtcclxuICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICBmbHRyID0gJGZpbHRlcignZmlsdGVyJykoYXJyLCB7aWQ6IGFycl9pZH0pWzBdLm5hbWU7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICBmbHRyID0gJGZpbHRlcignZmlsdGVyJykoYXJyLCB7aWQ6IGFycl9pZH0pWzBdLmNvdW50cnk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICBmbHRyID0gJGZpbHRlcignZmlsdGVyJykoYXJyLCB7aWQ6IGFycl9pZH0pWzBdLm5hdGlvbmFsaXR5O1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZsdHI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuZW1wcyA9IFtdO1xyXG4gIFxyXG4gICRzY29wZS5zYXZlRW1wbG95bWVudEhpc3RvcnkgPSBmdW5jdGlvbihlbXApe1xyXG4gICAgJHNjb3BlLmZybTNfbG9hZGVyID0gdHJ1ZTtcclxuICAgICRodHRwKHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHVybDogJy91c2VyL3NhdmVfZW1wbG95bWVudF9oaXN0b3J5JyxcclxuICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXHJcbiAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgZmQuYXBwZW5kKCdlbXAnLCBhbmd1bGFyLnRvSnNvbihkYXRhLmVtcCkpO1xyXG4gICAgICAgIHJldHVybiBmZDtcclxuICAgICAgfSxcclxuICAgICAgZGF0YToge2VtcDogZW1wfVxyXG4gICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAkc2NvcGUubXNnID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJHNjb3BlLmZybTNfbG9hZGVyID0gZmFsc2U7XHJcbiAgICAgICAgaWYoJHNjb3BlLm1zZ1snc3VjY2VzcyddKXtcclxuICAgICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXVsnZW1waGlzdG9yeSddKXtcclxuICAgICAgICAgICAgJHNjb3BlLmVtcHMgPSBbXTtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGVtcCwgZnVuY3Rpb24odmFsLCBrZXkpe1xyXG4gICAgICAgICAgICAgICRzY29wZS5qcGVtcHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAnZW1waWQnICAgICAgICAgIDogdmFsLmVtcGlkLFxyXG4gICAgICAgICAgICAgICAgJ2NvbXBhbnknICAgICAgICA6IHZhbC5jb21wYW55LFxyXG4gICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJyAgICAgICA6IHZhbC5wb3NpdGlvbixcclxuICAgICAgICAgICAgICAgICdjdXJyZW5jeScgICAgICAgOiB2YWwuY3VycmVuY3ksXHJcbiAgICAgICAgICAgICAgICAnc2FsYXJ5JyAgICAgICAgIDogdmFsLnNhbGFyeSxcclxuICAgICAgICAgICAgICAgICdzZGF0ZScgICAgICAgICAgOiB2YWwuc2RhdGUsXHJcbiAgICAgICAgICAgICAgICAnZWRhdGUnICAgICAgICAgIDogdmFsLmVkYXRlLFxyXG4gICAgICAgICAgICAgICAgJ2lzcHJlc2VudCcgICAgICA6IHZhbC5pc3ByZXNlbnQsXHJcbiAgICAgICAgICAgICAgICAnamJkZXNjcmlwdGlvbicgIDogdmFsLmpiZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgICAgICAncmVhc29uZm9ybGVhdmluZycgOiB2YWwucmVhc29uZm9ybGVhdmluZ1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIGlmKCRzY29wZS5tc2dbJ3RvX2NoYXJfcmVmJ10gPT0gdHJ1ZSl7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29sbGFwc2VUYWIoNCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJvZm9ybVsnZW1waGlzdG9yeSddID0gMTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdWNjZXNzX2VtcCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAvLyB1cGRhdGluZyByZXN1bWVcclxuICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlVXNyKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICRzY29wZS5zdWNjZXNzX2VtcCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9LCAzNTAwKTsgXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAyMDApO1xyXG4gICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXVsnZW1waGlzdG9yeSddKXtcclxuICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygnJywgYW5ndWxhci5lbGVtZW50KFwiI2VkdHByb2ZfYWNjcmRuXCIpLm9mZnNldCgpLnRvcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5tc2cpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gICRzY29wZS51cGRhdGVFbXBIaXN0b3J5ID0gZnVuY3Rpb24oaWR4LCBlbXApe1xyXG4gICAgJHNjb3BlLmZybTNfbG9hZGVyID0gdHJ1ZTtcclxuICAgICRodHRwKHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICB1cmw6ICcvdXNlci91cGRhdGVfZW1wbG95bWVudF9oaXN0b3J5JyxcclxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcclxuICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZmQgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICAgICAgZmQuYXBwZW5kKCdlbXAnLCBhbmd1bGFyLnRvSnNvbihkYXRhLmVtcCkpO1xyXG4gICAgICAgICAgICBmZC5hcHBlbmQoJ2lkeCcsIGFuZ3VsYXIudG9Kc29uKCdpbmR4JytkYXRhLmlkeCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXRhOiB7ZW1wOiBlbXAsIGlkeDogaWR4fVxyXG4gICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICRzY29wZS5tc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgJHNjb3BlLmZybTNfbG9hZGVyID0gZmFsc2U7XHJcbiAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzX2VtcCddKXtcclxuICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygnJywgYW5ndWxhci5lbGVtZW50KFwiLmVtcGtvXCIraWR4KS5vZmZzZXQoKS50b3AgLSA4MCk7XHJcbiAgICAgICAgICAkc2NvcGUuanBoaWRlW2lkeF0gPSBmYWxzZTtcclxuICAgICAgICAgICRzY29wZS5mcm1lbXB1cGR0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgLy8gdXBkYXRpbmcgcmVzdW1lXHJcbiAgICAgICAgICAkc2NvcGUudXBkYXRlVXNyKCk7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAkc2NvcGUubXNnWydzdWNjZXNzX2VtcCddID0gbnVsbDtcclxuICAgICAgICAgIH0sIDM1MDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuZW1wY2hja2J4ID0gJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmpwZW1wcywge2lzcHJlc2VudDogdHJ1ZX0pLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUubXNnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmFkZEVtcCA9IGZ1bmN0aW9uKGVtcCl7XHJcbiAgICAvLyAkc2NvcGUud3JrZXhwZXJpZW5jZSA9ICRzY29wZS5mcm0xWyd3cmtleHBlcmllbmNlJ107XHJcbiAgICAkc2NvcGUuZW1wcy51bnNoaWZ0KHtcclxuICAgICAgJ2VtcGlkJyAgICAgICAgICA6ICRzY29wZS5nZW5pZCgpLFxyXG4gICAgICAnY29tcGFueScgICAgICAgIDogXCJcIixcclxuICAgICAgJ3Bvc2l0aW9uJyAgICAgICA6IFwiXCIsXHJcbiAgICAgICdzYWxhcnknICAgICAgICAgOiBcIlwiLFxyXG4gICAgICAnc2RhdGUnICAgICAgICAgIDogXCJcIixcclxuICAgICAgJ2VkYXRlJyAgICAgICAgICA6IFwiXCIsXHJcbiAgICAgICdpc3ByZXNlbnQnICAgICAgOiBcIlwiLFxyXG4gICAgICAnamJkZXNjcmlwdGlvbicgIDogXCI8dWw+PGxpPjwvbGk+PGxpPjwvbGk+PGxpPjwvbGk+PGxpPjwvbGk+PC91bD5cIixcclxuICAgICAgJ3JlYXNvbmZvcmxlYXZpbmcnIDogXCI8dWw+PGxpPjwvbGk+PGxpPjwvbGk+PGxpPjwvbGk+PGxpPjwvbGk+PC91bD5cIlxyXG4gICAgfSk7XHJcbiAgICBpZigkc2NvcGUubXNnWydlcnJvciddKXtcclxuICAgICAgaWYodHlwZW9mICRzY29wZS5tc2dbJ2Vycm9yJ11bJ2VtcCddICE9IFwidW5kZWZpbmVkXCIpe1xyXG4gICAgICAgICRzY29wZS5tc2dbJ2Vycm9yJ11bJ2VtcCddLnNwbGljZSgwLCAwLCB7fSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgICRzY29wZS5jaGVja19lbXBzKCk7XHJcbiAgfVxyXG5cclxuICAkc2NvcGUudXBkYXRlRW1wRm9ybSA9IGZ1bmN0aW9uKGVtcCl7XHJcbiAgICAkc2NvcGUuZnJtM19sb2FkZXIgPSB0cnVlO1xyXG4gICAgJGh0dHAoe1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgdXJsOiAnL3VzZXIvd29ya19leHBlcmllbmNlJyxcclxuICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXHJcbiAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgZmQuYXBwZW5kKCd3cmtleHBlcmllbmNlJywgYW5ndWxhci50b0pzb24oZGF0YS5lbXApKTtcclxuICAgICAgICByZXR1cm4gZmQ7XHJcbiAgICAgIH0sXHJcbiAgICAgIGRhdGE6IHtlbXA6IGVtcH1cclxuICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcclxuICAgICAgJHNjb3BlLm1zZyA9IHJlc3VsdC5kYXRhO1xyXG5cclxuICAgICAgaWYoISRzY29wZS5qcGVtcHMubGVuZ3RoKXtcclxuICAgICAgICBpZihlbXAgPj0gMSAmJiAkc2NvcGUuZW1wcy5sZW5ndGggPCAxKXtcclxuICAgICAgICAgICRzY29wZS5lbXBzLnVuc2hpZnQoe1xyXG4gICAgICAgICAgICAnZW1waWQnICAgICAgICAgIDogJHNjb3BlLmdlbmlkKCksXHJcbiAgICAgICAgICAgICdjb21wYW55JyAgICAgICAgOiBcIlwiLFxyXG4gICAgICAgICAgICAncG9zaXRpb24nICAgICAgIDogXCJcIixcclxuICAgICAgICAgICAgJ3NhbGFyeScgICAgICAgICA6IFwiXCIsXHJcbiAgICAgICAgICAgICdzZGF0ZScgICAgICAgICAgOiBcIlwiLFxyXG4gICAgICAgICAgICAnZWRhdGUnICAgICAgICAgIDogXCJcIixcclxuICAgICAgICAgICAgJ2lzcHJlc2VudCcgICAgICA6IFwiXCIsXHJcbiAgICAgICAgICAgICdqYmRlc2NyaXB0aW9uJyAgOiBcIjx1bD48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48L3VsPlwiLFxyXG4gICAgICAgICAgICAncmVhc29uZm9ybGVhdmluZycgOiBcIjx1bD48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48L3VsPlwiXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYoZW1wID09IDEpe1xyXG4gICAgICAgICRzY29wZS5lbXBzID0gW107XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJHNjb3BlLmZybTNfbG9hZGVyID0gZmFsc2U7XHJcbiAgICAgICAgLy8gdXBkYXRpbmcgcmVzdW1lXHJcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVVzcigpO1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ11bJ2VtcGhpc3RvcnknXSAmJiBlbXAgPT0gMSl7XHJcbiAgICAgICAgICAgICRzY29wZS5jb2xsYXBzZVRhYig0KTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2Zvcm1bJ2VtcGhpc3RvcnknXSA9IDE7XHJcbiAgICAgICAgICAgICRzY29wZS5zdWNjZXNzX2VtcCA9IHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19lbXAgPSBmYWxzZTtcclxuICAgICAgICAgIH0sIDM1MDApOyBcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDIwMCk7XHJcbiAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgaWYoJHNjb3BlLm1zZ1snc3VjY2VzcyddWydlbXBoaXN0b3J5J10gJiYgZW1wID09IDEpe1xyXG4gICAgICAgICAgd2luZG93LnNjcm9sbFRvKCcnLCBhbmd1bGFyLmVsZW1lbnQoXCIjZWR0cHJvZl9hY2NyZG5cIikub2Zmc2V0KCkudG9wKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLm1zZyk7XHJcbiAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIGlmKHR5cGVvZiBlbXAgPT0gJ3VuZGVmaW5lZCcgfHwgZW1wID09IDEpe1xyXG4gICAgICAvLyAgICAkc2NvcGUuZW1wcy5wdXNoKHtcclxuICAgICAgLy8gICAgICAgICAnY29tcGFueScgICAgICAgIDogXCJcIixcclxuICAgICAgLy8gICAgICAgICAncG9zaXRpb24nICAgICAgIDogXCJcIixcclxuICAgICAgLy8gICAgICAgICAnc2FsYXJ5JyAgICAgICAgIDogXCJcIixcclxuICAgICAgLy8gICAgICAgICAnc2RhdGUnICAgICAgICAgIDogXCJcIixcclxuICAgICAgLy8gICAgICAgICAnZWRhdGUnICAgICAgICAgIDogXCJcIixcclxuICAgICAgLy8gICAgICAgICAnaXNwcmVzZW50JyAgICAgIDogXCJcIixcclxuICAgICAgLy8gICAgICAgICAnamJkZXNjcmlwdGlvbicgIDogXCI8dWw+PGxpPjwvbGk+PGxpPjwvbGk+PGxpPjwvbGk+PGxpPjwvbGk+PC91bD5cIixcclxuICAgICAgLy8gICAgICAgICAncmVhc29uZm9ybGVhdmluZycgOiBcIjx1bD48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48bGk+PC9saT48L3VsPlwiXHJcbiAgICAgIC8vICAgICB9KTtcclxuICAgICAgLy8gfVxyXG4gIH1cclxuICAkc2NvcGUuanBoaWRlID0gW107XHJcbiAgJHNjb3BlLmZybWVtcHVwZHQgPSBmYWxzZTtcclxuICAkc2NvcGUuZW1wZWR0Y2hja2J4ID0gZmFsc2U7XHJcblxyXG4gICRzY29wZS5kZWxldGVFbXAgPSBmdW5jdGlvbihlbXAsIGlkeCl7XHJcbiAgICBhbmd1bGFyLmVsZW1lbnQoJyNmcm1lbXB1cGR0JykuYXBwZW5kVG8oJyNlbXBjYXJkJyk7XHJcbiAgICAkaHR0cCh7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICB1cmw6ICcvdXNlci9kZWxldGVfZW1wbG95bWVudF9oaXN0b3J5JyxcclxuICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXHJcbiAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgZmQuYXBwZW5kKCdlbXAnLCBhbmd1bGFyLnRvSnNvbihkYXRhLmVtcCkpO1xyXG4gICAgICAgIHJldHVybiBmZDtcclxuICAgICAgfSxcclxuICAgICAgZGF0YToge2VtcDogZW1wfVxyXG4gICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAkc2NvcGUubXNnID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgIHZhciBpbmRleCA9ICRzY29wZS5qcGVtcHMuaW5kZXhPZihlbXApO1xyXG4gICAgICAkc2NvcGUuanBlbXBzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgIFxyXG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICRzY29wZS5mcm0zX2xvYWRlciA9IGZhbHNlO1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ11bJ2VtcGhpc3RvcnknXSl7XHJcbiAgICAgICAgICAgICRzY29wZS5zdWNjZXNzX2VtcCA9IHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAkc2NvcGUuZW1wYnRuZGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NfZW1wID0gZmFsc2U7XHJcbiAgICAgICAgICB9LCAzNTAwKTsgXHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAyMDApO1xyXG4gICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXVsnZW1waGlzdG9yeSddKXtcclxuICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygnJywgYW5ndWxhci5lbGVtZW50KFwiI2VkdHByb2ZfYWNjcmRuXCIpLm9mZnNldCgpLnRvcCk7XHJcbiAgICAgICAgICAvLyB1cGRhdGluZyByZXN1bWVcclxuICAgICAgICAgICRzY29wZS51cGRhdGVVc3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgJHNjb3BlLmVtcGNoY2tieCA9ICRmaWx0ZXIoJ2ZpbHRlcicpKCRzY29wZS5qcGVtcHMsIHtpc3ByZXNlbnQ6IHRydWV9KS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICRzY29wZS5lbXBlZHRjaGNrYnggPSAkZmlsdGVyKCdmaWx0ZXInKSgkc2NvcGUuanBlbXBzLCB7aXNwcmVzZW50OiB0cnVlfSkubGVuZ3RoID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICBcclxuICAgICAgLy8gY2xvc2UgcG9wIGRlbGV0ZVxyXG4gICAgICAkc2NvcGUuZGx0ZW1wW2lkeF0gPSBmYWxzZTtcclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLm1zZyk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgJHNjb3BlLnJlbW92ZUVtcCA9IGZ1bmN0aW9uKGVtcCl7XHJcbiAgICB2YXIgaW5kZXggPSAkc2NvcGUuZW1wcy5pbmRleE9mKGVtcCk7XHJcbiAgICAkc2NvcGUuZW1wcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgaWYoJHNjb3BlLm1zZ1snZXJyb3InXSl7XHJcbiAgICAgIGlmKHR5cGVvZiAkc2NvcGUubXNnWydlcnJvciddWydlbXAnXSAhPSAndW5kZWZpbmVkJyl7XHJcbiAgICAgICAgJHNjb3BlLm1zZ1snZXJyb3InXVsnZW1wJ10uc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgJHNjb3BlLmVtcGJ0bmRpc2FibGUgPSBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgJHNjb3BlLmVkaXRFbXBGb3JtID0gZnVuY3Rpb24oZW1wLCBpbmR4KXtcclxuICAgIHZhciBmbHRyID0gJGZpbHRlcignZmlsdGVyJykoJHNjb3BlLmpwZW1wcywge2lzcHJlc2VudDogdHJ1ZX0pLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcclxuICAgIGlmKGZsdHIgPT0gdHJ1ZSAmJiBlbXAuaXNwcmVzZW50ID09IGZhbHNlKXtcclxuICAgICAgJHNjb3BlLmVtcGVkdGNoY2tieCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZihlbXAuaXNwcmVzZW50ID09IHRydWUpe1xyXG4gICAgICAkc2NvcGUuZW1wZWR0Y2hja2J4ID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAkc2NvcGUuZW1wZWR0ID0gZW1wO1xyXG4gICAgJHNjb3BlLmVtcGVkdF9pbmR4ID0gaW5keDtcclxuICAgIHZhciBpO1xyXG4gICAgZm9yIChpID0gMDsgaSA8ICRzY29wZS5qcGVtcHMubGVuZ3RoOyBpKyspIHsgXHJcbiAgICAgICRzY29wZS5qcGhpZGVbaV0gPSBmYWxzZTtcclxuICAgIH1cclxuICAgICRzY29wZS5qcGhpZGVbaW5keF0gPSB0cnVlO1xyXG4gICAgJHNjb3BlLmZybWVtcHVwZHQgPSB0cnVlO1xyXG4gICAgYW5ndWxhci5lbGVtZW50KCcjZnJtZW1wdXBkdCcpLmFwcGVuZFRvKCcuZW1wa28nK2luZHgpO1xyXG5cclxuICAgIGlmKCRzY29wZS5tc2dbJ2Vycm9yJ10pe1xyXG4gICAgICBpZih0eXBlb2YgJHNjb3BlLm1zZ1snZXJyb3InXVsnZW1wJ10gIT0gJ3VuZGVmaW5lZCcpe1xyXG4gICAgICAgICRzY29wZS5tc2dbJ2Vycm9yJ11bJ2VtcCddID0ge307XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gICRzY29wZS5jaGVja2VkID0gMDtcclxuICAkc2NvcGUuY2xlYXJFbmRhdGUgPSBmdW5jdGlvbihpbmRleCwgaXNwcmVzZW50LCBtdGhkKXtcclxuICAgIGlmKGlzcHJlc2VudCA9PSAxKXtcclxuICAgICAgc3dpdGNoKG10aGQpe1xyXG4gICAgICAgIGNhc2UgJ2FkZCc6XHJcbiAgICAgICAgICAkc2NvcGUuZW1wc1tpbmRleF0uZWRhdGUgPSAnJztcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2VkdCc6XHJcbiAgICAgICAgICAkc2NvcGUuZW1wZWR0LmVkYXRlID0gJyc7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICAkc2NvcGUuY2hlY2tlZCsrO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICRzY29wZS5jaGVja2VkLS07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuanBjaHJzID0gW107XHJcbiAgJHNjb3BlLmNocmhpZGUgPSBbXTtcclxuICAkc2NvcGUuY2hycyA9IFtdO1xyXG4gICRzY29wZS5jaHJidG5kaXNhYmxlID0gZmFsc2U7XHJcbiAgJHNjb3BlLmZybWNocnVwZHQgPSBmYWxzZTtcclxuICBDaHJSZWYucXVlcnkoKS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICRzY29wZS5qcGNocnMgPSBkYXRhO1xyXG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgaWYoJHNjb3BlLnVzcil7XHJcbiAgICAgICAgaWYoISRzY29wZS5qcGNocnMubGVuZ3RoKXtcclxuICAgICAgICAgICRzY29wZS5jaHJzID0gW3tcclxuICAgICAgICAgICAgJ2NocmlkJyAgICA6ICRzY29wZS5nZW5pZCgpLFxyXG4gICAgICAgICAgICAnbmFtZScgICAgIDogXCJcIixcclxuICAgICAgICAgIH1dO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgMTAwKTtcclxuICB9KTtcclxuXHJcbiAgJHNjb3BlLmFkZENoYXIgPSBmdW5jdGlvbihjaHIpe1xyXG4gICAgJHNjb3BlLmNocnMudW5zaGlmdCh7XHJcbiAgICAgICdjaHJpZCcgICAgOiAkc2NvcGUuZ2VuaWQoKSxcclxuICAgICAgJ25hbWUnICAgICA6IFwiXCIsXHJcbiAgICB9KTtcclxuICAgIGlmKCRzY29wZS5tc2dbJ2Vycm9yJ10pe1xyXG4gICAgICBpZih0eXBlb2YgJHNjb3BlLm1zZ1snZXJyb3InXVsnY2hyJ10gIT0gXCJ1bmRlZmluZWRcIil7XHJcbiAgICAgICAgJHNjb3BlLm1zZ1snZXJyb3InXVsnY2hyJ10uc3BsaWNlKDAsIDAsIHt9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYoJHNjb3BlLmNocnMgJiYgJHNjb3BlLmpwY2hycyl7XHJcbiAgICAgIGlmKCRzY29wZS5jaHJzLmxlbmd0aCA+IDIgLSAkc2NvcGUuanBjaHJzLmxlbmd0aCl7XHJcbiAgICAgICAgJHNjb3BlLmNocmJ0bmRpc2FibGUgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAkc2NvcGUuc2F2ZUNoYXJSZWYgPSBmdW5jdGlvbihjaHIpe1xyXG4gICAgJHNjb3BlLmZybTRfbG9hZGVyID0gdHJ1ZTtcclxuICAgICRodHRwKHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHVybDogJy91c2VyL3NhdmVfY2hhcl9yZWYnLFxyXG4gICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcclxuICAgICAgdHJhbnNmb3JtUmVxdWVzdDogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgZmQgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICBmZC5hcHBlbmQoJ2NocicsIGFuZ3VsYXIudG9Kc29uKGRhdGEuY2hyKSk7XHJcbiAgICAgICAgcmV0dXJuIGZkO1xyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiB7Y2hyOiBjaHJ9XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgICRzY29wZS5tc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAkc2NvcGUuZnJtNF9sb2FkZXIgPSBmYWxzZTtcclxuICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ10pe1xyXG4gICAgICAgICAgaWYoJHNjb3BlLm1zZ1snc3VjY2VzcyddWydjaHJyZWZlcmVuY2UnXSl7XHJcbiAgICAgICAgICAgICRzY29wZS5jaHJzID0gW107XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjaHIsIGZ1bmN0aW9uKHZhbCwga2V5KXtcclxuICAgICAgICAgICAgICAkc2NvcGUuanBjaHJzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgJ2NocmlkJyAgICAgICA6IHZhbC5jaHJpZCxcclxuICAgICAgICAgICAgICAgICduYW1lJyAgICAgICAgOiB2YWwubmFtZSxcclxuICAgICAgICAgICAgICAgICdjb21wYW55JyAgICAgOiB2YWwuY29tcGFueSxcclxuICAgICAgICAgICAgICAgICdwb3NpdGlvbicgICAgOiB2YWwucG9zaXRpb24sXHJcbiAgICAgICAgICAgICAgICAncmVsYXRpb24nICAgIDogdmFsLnJlbGF0aW9uLFxyXG4gICAgICAgICAgICAgICAgJ2VtYWlsJyAgICAgICA6IHZhbC5lbWFpbCxcclxuICAgICAgICAgICAgICAgICdwaG9uZScgICAgICAgOiB2YWwucGhvbmVcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19jaHIgPSB0cnVlO1xyXG4gICAgICAgICAgICAgIC8vIHVwZGF0aW5nIHJlc3VtZVxyXG4gICAgICAgICAgICAgICRzY29wZS51cGRhdGVVc3IoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NfY2hyID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0sIDM1MDApOyBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sIDIwMCk7XHJcbiAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgaWYoJHNjb3BlLm1zZ1snc3VjY2VzcyddWydjaHJyZWZlcmVuY2UnXSl7XHJcbiAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oJycsIGFuZ3VsYXIuZWxlbWVudChcIiNlZHRwcm9mX2FjY3JkblwiKS5vZmZzZXQoKS50b3ApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmxvZygkc2NvcGUubXNnKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmVkaXRDaHJGb3JtID0gZnVuY3Rpb24oY2hyLCBpbmR4KXtcclxuICAgICRzY29wZS5jaHJlZHQgPSBjaHI7XHJcbiAgICAkc2NvcGUuY2hyZWR0X2luZHggPSBpbmR4O1xyXG4gICAgdmFyIGk7XHJcbiAgICBmb3IgKGkgPSAwOyBpIDwgJHNjb3BlLmpwY2hycy5sZW5ndGg7IGkrKykgeyBcclxuICAgICAgJHNjb3BlLmNocmhpZGVbaV0gPSBmYWxzZTtcclxuICAgIH1cclxuICAgICRzY29wZS5jaHJoaWRlW2luZHhdID0gdHJ1ZTtcclxuICAgICRzY29wZS5mcm1jaHJ1cGR0ID0gdHJ1ZTtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgnI2ZybWNocnVwZHQnKS5hcHBlbmRUbygnLmNocmtvJytpbmR4KTtcclxuXHJcbiAgICBpZigkc2NvcGUubXNnWydlcnJvciddKXtcclxuICAgICAgaWYodHlwZW9mICRzY29wZS5tc2dbJ2Vycm9yJ11bJ2NociddICE9ICd1bmRlZmluZWQnKXtcclxuICAgICAgICAkc2NvcGUubXNnWydlcnJvciddWydjaHInXSA9IHt9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAkc2NvcGUucmVtb3ZlQ2hyID0gZnVuY3Rpb24oY2hyKXtcclxuICAgIHZhciBpbmRleCA9ICRzY29wZS5jaHJzLmluZGV4T2YoY2hyKTtcclxuICAgICRzY29wZS5jaHJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICBpZigkc2NvcGUubXNnWydlcnJvciddKXtcclxuICAgICAgaWYodHlwZW9mICRzY29wZS5tc2dbJ2Vycm9yJ11bJ2NociddICE9ICd1bmRlZmluZWQnKXtcclxuICAgICAgICAkc2NvcGUubXNnWydlcnJvciddWydjaHInXS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICAkc2NvcGUuY2hyYnRuZGlzYWJsZSA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgJHNjb3BlLnVwZGF0ZUNoclJlZiA9IGZ1bmN0aW9uKGlkeCwgY2hyKXtcclxuICAgICRzY29wZS5mcm00X2xvYWRlciA9IHRydWU7XHJcbiAgICAkaHR0cCh7XHJcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgdXJsOiAnL3VzZXIvdXBkYXRlX2NoYXJfcmVmJyxcclxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiB1bmRlZmluZWQgfSxcclxuICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgZmQgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICAgICAgZmQuYXBwZW5kKCdjaHInLCBhbmd1bGFyLnRvSnNvbihkYXRhLmNocikpO1xyXG4gICAgICAgICAgICBmZC5hcHBlbmQoJ2lkeCcsIGFuZ3VsYXIudG9Kc29uKCdpbmR4JytkYXRhLmlkeCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXRhOiB7Y2hyOiBjaHIsIGlkeDogaWR4fVxyXG4gICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICRzY29wZS5tc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgJHNjb3BlLmZybTRfbG9hZGVyID0gZmFsc2U7XHJcbiAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzX2NociddKXtcclxuICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygnJywgYW5ndWxhci5lbGVtZW50KFwiLmNocmtvXCIraWR4KS5vZmZzZXQoKS50b3AgLSA2MCk7XHJcbiAgICAgICAgICAkc2NvcGUuY2hyaGlkZVtpZHhdID0gZmFsc2U7XHJcbiAgICAgICAgICAkc2NvcGUuZnJtY2hydXBkdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgIC8vIHVwZGF0aW5nIHJlc3VtZVxyXG4gICAgICAgICAgJHNjb3BlLnVwZGF0ZVVzcigpO1xyXG4gICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgJHNjb3BlLm1zZ1snc3VjY2Vzc19jaHInXSA9IG51bGw7XHJcbiAgICAgICAgICB9LCAzNTAwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLm1zZyk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgJHNjb3BlLmRlbGV0ZUNociA9IGZ1bmN0aW9uKGNociwgaWR4KXtcclxuICAgIGFuZ3VsYXIuZWxlbWVudCgnI2ZybWNocnVwZHQnKS5hcHBlbmRUbygnI2NocmNhcmQnKTtcclxuICAgICRodHRwKHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHVybDogJy91c2VyL2RlbGV0ZV9jaGFyYWN0ZXJfcmVmJyxcclxuICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXHJcbiAgICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgZmQuYXBwZW5kKCdjaHInLCBhbmd1bGFyLnRvSnNvbihkYXRhLmNocikpO1xyXG4gICAgICAgIHJldHVybiBmZDtcclxuICAgICAgfSxcclxuICAgICAgZGF0YToge2NocjogY2hyfVxyXG4gICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAkc2NvcGUubXNnID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgIHZhciBpbmRleCA9ICRzY29wZS5qcGNocnMuaW5kZXhPZihjaHIpO1xyXG4gICAgICAkc2NvcGUuanBjaHJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgIFxyXG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICRzY29wZS5mcm00X2xvYWRlciA9IGZhbHNlO1xyXG4gICAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgICBpZigkc2NvcGUubXNnWydzdWNjZXNzJ11bJ2NocnJlZmVyZW5jZSddKXtcclxuICAgICAgICAgICAgJHNjb3BlLnN1Y2Nlc3NfY2hyID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgICRzY29wZS5jaHJidG5kaXNhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAkc2NvcGUuc3VjY2Vzc19jaHIgPSBmYWxzZTtcclxuICAgICAgICAgIH0sIDM1MDApOyBcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDIwMCk7XHJcbiAgICAgIGlmKCRzY29wZS5tc2dbJ3N1Y2Nlc3MnXSl7XHJcbiAgICAgICAgaWYoJHNjb3BlLm1zZ1snc3VjY2VzcyddWydjaHJyZWZlcmVuY2UnXSl7XHJcbiAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oJycsIGFuZ3VsYXIuZWxlbWVudChcIiNlZHRwcm9mX2FjY3JkblwiKS5vZmZzZXQoKS50b3ApO1xyXG4gICAgICAgICAgLy8gdXBkYXRpbmcgcmVzdW1lXHJcbiAgICAgICAgICAkc2NvcGUudXBkYXRlVXNyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIGNsb3NlIHBvcCBkZWxldGVcclxuICAgICAgJHNjb3BlLmRsdGNocltpZHhdID0gZmFsc2U7XHJcbiAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5tc2cpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gICRzY29wZS5zaG93bGJsID0gZnVuY3Rpb24oaWR4LCBudW0pe1xyXG4gICAgc3dpdGNoKG51bSl7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICAkc2NvcGUuanBoaWRlW2lkeF0gPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuZnJtZW1wdXBkdCA9IGZhbHNlO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgJHNjb3BlLmNocmhpZGVbaWR4XSA9IGZhbHNlO1xyXG4gICAgICAgICRzY29wZS5mcm1jaHJ1cGR0ID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG4gICRzY29wZS52aWV3UmVzdW1lID0gZnVuY3Rpb24oKXtcclxuICAgICQoJyNyZXN1bWVfdHBsJykuYXBwZW5kVG8oJ2JvZHknKS5tb2RhbCgpLnZlbG9jaXR5KCd0cmFuc2l0aW9uLmZsaXBYSW4nKTtcclxuICB9XHJcbiAgJHNjb3BlLmdlbmlkID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgdnJ0eHQgPSBcIlwiO1xyXG4gICAgdmFyIHZycG9zc2libGUgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5XCI7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDIwOyBpKyspe1xyXG4gICAgICB2cnR4dCArPSB2cnBvc3NpYmxlLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB2cnBvc3NpYmxlLmxlbmd0aCkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZydHh0O1xyXG4gIH1cclxuXHJcbn1dKTtcclxudXNyQ29udGVudC5maWx0ZXIoJ2N1c3RvbU9yZGVyQnknLCBmdW5jdGlvbiAoKSB7XHJcbiAgIHJldHVybiBmdW5jdGlvbiAoYXJyKSB7XHJcblxyXG4gICAgIHZhciBudW1iZXJzID0gW107XHJcbiAgICAgdmFyIHN0cmluZ3MgPSBbXTtcclxuICAgICAgIGFuZ3VsYXIuZm9yRWFjaChhcnIsIGZ1bmN0aW9uKGl0ZW0pe1xyXG4gICAgICAgICAgICBpZihpdGVtLmlzcHJlc2VudCA9PSB0cnVlICl7XHJcbiAgICAgICAgICAgICAgbnVtYmVycy5wdXNoKGl0ZW0pOyAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgIHN0cmluZ3MucHVzaChpdGVtKTsgICAgIFxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBudW1iZXJzLnNvcnQoKS5jb25jYXQoc3RyaW5ncyk7XHJcbiAgICB9O1xyXG59KTtcclxudXNyQ29udGVudC5kaXJlY3RpdmUoJ2ZpbGVJbnB1dCcsIFsnJHBhcnNlJywgJyRodHRwJywgJyR0aW1lb3V0JyxcclxuICAgIGZ1bmN0aW9uKCRwYXJzZSwgJGh0dHAsICR0aW1lb3V0KXtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxtLCBhdHRycyl7XHJcbiAgICAgICAgICBlbG0uYmluZCgnY2hhbmdlJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGZpbGVzID0gZWxtWzBdLmZpbGVzO1xyXG4gICAgICAgICAgICAkcGFyc2UoYXR0cnMuZmlsZUlucHV0KS5hc3NpZ24oc2NvcGUsIGZpbGVzKTtcclxuICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBzY29wZS5zaHdfYXZhdGFybWRsID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2NvcGUubG9hZGVyID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi92YWxpZGF0ZV9kcFwiLFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm1SZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmZCA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLmltZ19maWxlcywgZnVuY3Rpb24oZmlsZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgZmQuYXBwZW5kKCdmaWxlJywgZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZkO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtpbWdfZmlsZXM6IGZpbGVzfVxyXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgbXNnID0gcmVzdWx0LmRhdGE7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5zaHdfYXZhdGFybWRsID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCFtc2dbJ2RwJ11bJ2Vycm9yJ11bJ2ZpbGUnXSl7XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcjY3JvcE1vZGFsJykuYXBwZW5kVG8oJ2JvZHknKS5tb2RhbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tkcm9wOiAnc3RhdGljJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZmlsZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKGZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltZ1RhcmdldCA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmltZ0Zvcm0oaW1nVGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0oZmlsZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLm1zZyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUubXNnID0gbXNnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufV0pO1xyXG5cclxudXNyQ29udGVudC5kaXJlY3RpdmUoJ2ZpbGVSZXN1bWUnLCBbJyRwYXJzZScsICckaHR0cCcsICckdGltZW91dCcsXHJcbiAgICBmdW5jdGlvbigkcGFyc2UsICRodHRwLCAkdGltZW91dCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsbSwgYXR0cnMpe1xyXG4gICAgICAgICAgICBlbG0uYmluZCgnY2hhbmdlJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlcyA9IGVsbVswXS5maWxlcztcclxuICAgICAgICAgICAgICAgICRwYXJzZShhdHRycy5maWxlUmVzdW1lKS5hc3NpZ24oc2NvcGUsIGZpbGVzKTtcclxuICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBzY29wZS5yZXN1bWVfbG9hZGVyID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi91cGxvYWRfcmVzdW1lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogdW5kZWZpbmVkIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtUmVxdWVzdDogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLnJlc3VtZWZpbGVzLCBmdW5jdGlvbihmaWxlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZmQuYXBwZW5kKCdmaWxlJywgZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7cmVzdW1lZmlsZXM6IGZpbGVzfVxyXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtc2cgPSByZXN1bHQuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc3VtZV9sb2FkZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudXBkYXRlVXNyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFtc2dbJ3Jlc3VtZSddKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm1zZyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm1zZyA9IG1zZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy5wcmV2aWV3X3Jlc3VtZSAudXBsb2FkJykudmFsKCcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1dKTtcclxuXHJcblxyXG51c3JDb250ZW50LmRpcmVjdGl2ZSgnanBDdXN0b21Dcm9wJywgWyckcGFyc2UnLCAnJHJvb3RTY29wZScsICckdGltZW91dCcsIGZ1bmN0aW9uKCRwYXJzZSwgJHJvb3RTY29wZSwgJHRpbWVvdXQpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycylcclxuICAgICAge1xyXG4gICAgICAgICQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgJCgnI2Nyb3BNb2RhbCcpLm9uKCdzaG93bi5icy5tb2RhbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5sb2FkZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkKCcuaW1nY3JvcHBlciwgLnBydncnKS5oaWRlKCkuZGVsYXkoJzIwMCcpLmZhZGVJbigpO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwMClcclxuICAgICAgICAgICAgICB2YXIgamNyb3BfYXBpLFxyXG4gICAgICAgICAgICAgIGJvdW5keCxcclxuICAgICAgICAgICAgICBib3VuZHksXHJcblxyXG4gICAgICAgICAgICAgIC8vIEdyYWIgc29tZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgcHJldmlldyBwYW5lXHJcbiAgICAgICAgICAgICAgJHByZXZpZXcgPSAkKCcucHJldmlldy1wYW5lJyksXHJcbiAgICAgICAgICAgICAgJHBjbnQgPSAkKCcucHJldmlldy1wYW5lIC5wcmV2aWV3LWNvbnRhaW5lcicpLFxyXG4gICAgICAgICAgICAgICRwaW1nID0gJCgnLnByZXZpZXctcGFuZSAucHJldmlldy1jb250YWluZXIgaW1nJyksXHJcbiAgICAgICAgICAgICAgeHNpemUgPSAkcGNudC53aWR0aCgpLFxyXG4gICAgICAgICAgICAgIHlzaXplID0gJHBjbnQuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgJCgnI3RhcmdldCcpLkpjcm9wKHtcclxuICAgICAgICAgICAgICAgIGJveFdpZHRoOiA2NzAsXHJcbiAgICAgICAgICAgICAgICAvLyBib3hIZWlnaHQ6IDU1MCxcclxuICAgICAgICAgICAgICAgIG1pblNpemU6IFsgMTAwLCAxMDAgXSxcclxuICAgICAgICAgICAgICAgIC8vIG1heFNpemU6IFsgNDUwLCA0NTAgXSxcclxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB1cGRhdGVQcmV2aWV3LFxyXG4gICAgICAgICAgICAgICAgb25TZWxlY3Q6IHVwZGF0ZVByZXZpZXcsXHJcbiAgICAgICAgICAgICAgICBhc3BlY3RSYXRpbzogeHNpemUgLyB5c2l6ZVxyXG4gICAgICAgICAgICAgIH0sZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIC8vIFVzZSB0aGUgQVBJIHRvIGdldCB0aGUgcmVhbCBpbWFnZSBzaXplXHJcbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpcy5nZXRCb3VuZHMoKTtcclxuICAgICAgICAgICAgICAgIGJvdW5keCA9IGJvdW5kc1swXTtcclxuICAgICAgICAgICAgICAgIGJvdW5keSA9IGJvdW5kc1sxXTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIEFQSSBpbiB0aGUgamNyb3BfYXBpIHZhcmlhYmxlXHJcbiAgICAgICAgICAgICAgICBqY3JvcF9hcGkgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgamNyb3BfYXBpLmFuaW1hdGVUbyhbNTEwLCAzMDAsIDE5MCwgMTAwXSk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gdXBkYXRlUHJldmlldyhjKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1neCA9IE1hdGgucm91bmQoYy54KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1neSA9IE1hdGgucm91bmQoYy55KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1ndyA9IE1hdGgucm91bmQoYy53KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1naCA9IE1hdGgucm91bmQoYy5oKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1ndzIgPSB4c2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1naDIgPSB5c2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5pbWdfY29vcmRpbmF0ZXMoe2ltZ3gsIGltZ3ksIGltZ3csIGltZ2gsIGltZ3cyLCBpbWdoMn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChjLncpID4gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcnggPSB4c2l6ZSAvIGMudztcclxuICAgICAgICAgICAgICAgICAgICAgIHZhciByeSA9IHlzaXplIC8gYy5oO1xyXG4gICAgICAgICAgICAgICAgICAgICAgJHBpbWcuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IE1hdGgucm91bmQocnggKiBib3VuZHgpICsgJ3B4JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBNYXRoLnJvdW5kKHJ5ICogYm91bmR5KSArICdweCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6ICctJyArIE1hdGgucm91bmQocnggKiBjLngpICsgJ3B4JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiAnLScgKyBNYXRoLnJvdW5kKHJ5ICogYy55KSArICdweCdcclxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbn1dKTtcclxudXNyQ29udGVudC5kaXJlY3RpdmUoJ2N1cnJlbmN5SW5wdXQnLCBbZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xyXG4gICAgICAgICAgICBhdHRycy4kc2V0KCduZ1RyaW0nLCBcImZhbHNlXCIpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGZvcm1hdHRlciA9IGZ1bmN0aW9uKHN0ciwgaXNOdW0pIHtcclxuICAgICAgICAgICAgICAgIHN0ciA9IFN0cmluZyggTnVtYmVyKHN0ciB8fCAwKSAvIChpc051bT8xOjEwMCkgKTtcclxuICAgICAgICAgICAgICAgIHN0ciA9IChzdHI9PScwJz8nMC4wJzpzdHIpLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgICAgICAgICBzdHJbMV0gPSBzdHJbMV0gfHwgJzAnO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0clswXS5yZXBsYWNlKC8oXFxkKSg/PShcXGRcXGRcXGQpKyg/IVxcZCkpL2csICckMSwnKSArICcuJyArIChzdHJbMV0ubGVuZ3RoPT0xP3N0clsxXSsnMCc6c3RyWzFdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdXBkYXRlVmlldyA9IGZ1bmN0aW9uKHZhbCkge1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5QXN5bmMoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZSh2YWwgfHwgJycpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHBhcnNlTnVtYmVyID0gZnVuY3Rpb24odmFsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxTdHJpbmcgPSBmb3JtYXR0ZXIobmdNb2RlbC4kbW9kZWxWYWx1ZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2lnbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3M6IC9bK10vLnRlc3QodmFsKSxcclxuICAgICAgICAgICAgICAgICAgICBuZWc6IC9bLV0vLnRlc3QodmFsKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2lnbi5oYXMgPSBzaWduLnBvcyB8fCBzaWduLm5lZztcclxuICAgICAgICAgICAgICAgIHNpZ24uYm90aCA9IHNpZ24ucG9zICYmIHNpZ24ubmVnO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghdmFsIHx8IHNpZ24uaGFzICYmIHZhbC5sZW5ndGg9PTEgfHwgbmdNb2RlbC4kbW9kZWxWYWx1ZSAmJiBOdW1iZXIodmFsKT09PTApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VmFsID0gKCF2YWwgfHwgbmdNb2RlbC4kbW9kZWxWYWx1ZSAmJiBOdW1iZXIoKT09PTA/Jyc6dmFsKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmdNb2RlbC4kbW9kZWxWYWx1ZSAhPT0gbmV3VmFsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVWaWV3KG5ld1ZhbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWxTdHJpbmcgPSBTdHJpbmcodmFsIHx8ICcnKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3U2lnbiA9IChzaWduLmJvdGggJiYgbmdNb2RlbC4kbW9kZWxWYWx1ZT49MCB8fCAhc2lnbi5ib3RoICYmIHNpZ24ubmVnPyctJzonJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1ZhbCA9IHZhbFN0cmluZy5yZXBsYWNlKC9bXjAtOV0vZywnJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXdWYWwgPSBuZXdTaWduICsgZm9ybWF0dGVyKGFuZ3VsYXIuY29weShuZXdWYWwpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsU3RyaW5nICE9PSB2YWxTdHJpbmcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVZpZXcodmlld1ZhbCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoTnVtYmVyKG5ld1NpZ24gKyBuZXdWYWwpIC8gMTAwKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBmb3JtYXROdW1iZXIgPSBmdW5jdGlvbih2YWwpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gU3RyaW5nKHZhbCkuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgICAgICAgICBzdHJbMV0gPSBzdHJbMV0gfHwgJzAnO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbCA9IHN0clswXSArICcuJyArIChzdHJbMV0ubGVuZ3RoPT0xP3N0clsxXSsnMCc6c3RyWzFdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZU51bWJlcih2YWwpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBuZ01vZGVsLiRwYXJzZXJzLnB1c2gocGFyc2VOdW1iZXIpO1xyXG4gICAgICAgICAgICBuZ01vZGVsLiRmb3JtYXR0ZXJzLnB1c2goZm9ybWF0TnVtYmVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHJlc291cmNlcy9hc3NldHMvanMvYXBwL3VzZXIvZWRpdF9wcm9maWxlLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OztBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=");

/***/ }
/******/ ]);